# Pandas merge vs concat ì™„ì „ ê°€ì´ë“œ

## ğŸ¯ í•µì‹¬ ìš”ì•½

| êµ¬ë¶„ | **merge** | **concat** |
|------|-----------|------------|
| **ê²°í•© ë°©ì‹** | í‚¤ ì»¬ëŸ¼ ê¸°ì¤€ ì¡°ì¸ (SQL ìŠ¤íƒ€ì¼) | ë¬¼ë¦¬ì  ë¶™ì´ê¸° (Union ìŠ¤íƒ€ì¼) |
| **ìš©ë„** | ê´€ê³„í˜• ë°ì´í„° ê²°í•© | ë°ì´í„° ì¶”ê°€/í™•ì¥ |
| **ì¡°ì¸ ì¢…ë¥˜** | inner, outer, left, right | - |
| **ì¤‘ë³µ ì²˜ë¦¬** | ìë™ ì²˜ë¦¬ | ê·¸ëŒ€ë¡œ ìœ ì§€ |
| **ì„±ëŠ¥** | ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦¼ | ë¹ ë¦„ |
| **ì¸ë±ìŠ¤** | í‚¤ ì»¬ëŸ¼ ê¸°ì¤€ ì¬êµ¬ì„± | ê¸°ì¡´ ì¸ë±ìŠ¤ ìœ ì§€ ê°€ëŠ¥ |

---

## ğŸ”— **merge: ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤íƒ€ì¼ ì¡°ì¸**

### ê¸°ë³¸ ê°œë…
```python
import pandas as pd

# í•™ìƒ ì •ë³´ í…Œì´ë¸”
students = pd.DataFrame({
    'student_id': [1, 2, 3],
    'name': ['ê¹€ì² ìˆ˜', 'ì´ì˜í¬', 'ë°•ë¯¼ìˆ˜']
})

# ì„±ì  ì •ë³´ í…Œì´ë¸”  
scores = pd.DataFrame({
    'student_id': [1, 2, 4],  # 3ë²ˆì€ ì—†ê³  4ë²ˆì´ ìˆìŒ
    'score': [85, 92, 78]
})

print("í•™ìƒ ì •ë³´:")
print(students)
print("\nì„±ì  ì •ë³´:")
print(scores)
```

### mergeì˜ 4ê°€ì§€ ì¡°ì¸ ë°©ì‹

#### 1ï¸âƒ£ Inner Join (êµì§‘í•©)
```python
inner_result = pd.merge(students, scores, on='student_id', how='inner')
print("Inner Join ê²°ê³¼:")
print(inner_result)
```
**ê²°ê³¼**: ì–‘ìª½ì— ëª¨ë‘ ìˆëŠ” í•™ìƒë§Œ (ê¹€ì² ìˆ˜, ì´ì˜í¬)

#### 2ï¸âƒ£ Left Join (ì™¼ìª½ ê¸°ì¤€)
```python
left_result = pd.merge(students, scores, on='student_id', how='left')
print("Left Join ê²°ê³¼:")
print(left_result)
```
**ê²°ê³¼**: ëª¨ë“  í•™ìƒ ì •ë³´ ìœ ì§€, ì„±ì  ì—†ìœ¼ë©´ NaN

#### 3ï¸âƒ£ Right Join (ì˜¤ë¥¸ìª½ ê¸°ì¤€)
```python
right_result = pd.merge(students, scores, on='student_id', how='right')
print("Right Join ê²°ê³¼:")
print(right_result)
```
**ê²°ê³¼**: ëª¨ë“  ì„±ì  ì •ë³´ ìœ ì§€, í•™ìƒ ì •ë³´ ì—†ìœ¼ë©´ NaN

#### 4ï¸âƒ£ Outer Join (í•©ì§‘í•©)
```python
outer_result = pd.merge(students, scores, on='student_id', how='outer')
print("Outer Join ê²°ê³¼:")
print(outer_result)
```
**ê²°ê³¼**: ëª¨ë“  ë°ì´í„° í¬í•¨, ì—†ëŠ” ë¶€ë¶„ì€ NaN

### merge ê³ ê¸‰ í™œìš©

#### ë‹¤ë¥¸ ì»¬ëŸ¼ëª…ìœ¼ë¡œ ì¡°ì¸
```python
# ì»¬ëŸ¼ëª…ì´ ë‹¤ë¥¼ ë•Œ
df1 = pd.DataFrame({'id': [1, 2], 'data1': ['A', 'B']})
df2 = pd.DataFrame({'student_id': [1, 2], 'data2': ['X', 'Y']})

result = pd.merge(df1, df2, left_on='id', right_on='student_id')
```

#### ì—¬ëŸ¬ ì»¬ëŸ¼ìœ¼ë¡œ ì¡°ì¸
```python
result = pd.merge(df1, df2, on=['id', 'category'], how='inner')
```

#### ì ‘ë¯¸ì‚¬ ì§€ì •
```python
result = pd.merge(df1, df2, on='id', suffixes=('_left', '_right'))
```

---

## ğŸ“š **concat: ë°ì´í„°í”„ë ˆì„ ë¬¼ë¦¬ì  ì—°ê²°**

### ê¸°ë³¸ ê°œë…
```python
# 1ì›” ë§¤ì¶œ ë°ì´í„°
jan_sales = pd.DataFrame({
    'product': ['A', 'B'],
    'sales': [100, 150]
})

# 2ì›” ë§¤ì¶œ ë°ì´í„°
feb_sales = pd.DataFrame({
    'product': ['A', 'B'], 
    'sales': [120, 180]
})

print("1ì›” ë§¤ì¶œ:")
print(jan_sales)
print("\n2ì›” ë§¤ì¶œ:")
print(feb_sales)
```

### concatì˜ 2ê°€ì§€ ì—°ê²° ë°©í–¥

#### 1ï¸âƒ£ ì„¸ë¡œ ì—°ê²° (axis=0, ê¸°ë³¸ê°’)
```python
vertical_concat = pd.concat([jan_sales, feb_sales], ignore_index=True)
print("ì„¸ë¡œ ì—°ê²° ê²°ê³¼:")
print(vertical_concat)
```
**ê²°ê³¼**: í–‰ì´ ì•„ë˜ë¡œ ì¶”ê°€ë¨ (4í–‰ 2ì—´)

#### 2ï¸âƒ£ ê°€ë¡œ ì—°ê²° (axis=1)
```python
horizontal_concat = pd.concat([jan_sales, feb_sales], axis=1)
print("ê°€ë¡œ ì—°ê²° ê²°ê³¼:")
print(horizontal_concat)
```
**ê²°ê³¼**: ì»¬ëŸ¼ì´ ì˜†ìœ¼ë¡œ ì¶”ê°€ë¨ (2í–‰ 4ì—´)

### concat ê³ ê¸‰ ì˜µì…˜

#### í‚¤(ê³„ì¸µ) ì¶”ê°€
```python
result = pd.concat([jan_sales, feb_sales], keys=['1ì›”', '2ì›”'])
print("ê³„ì¸µ ì¸ë±ìŠ¤ë¡œ ì—°ê²°:")
print(result)
```

#### êµì§‘í•©/í•©ì§‘í•© ì„¤ì •
```python
# ê³µí†µ ì»¬ëŸ¼ë§Œ (êµì§‘í•©)
result = pd.concat([df1, df2], join='inner')

# ëª¨ë“  ì»¬ëŸ¼ í¬í•¨ (í•©ì§‘í•©, ê¸°ë³¸ê°’)
result = pd.concat([df1, df2], join='outer')
```

#### ì¸ë±ìŠ¤ ë¬´ì‹œ
```python
result = pd.concat([df1, df2], ignore_index=True)  # 0, 1, 2, 3... ìƒˆë¡œ ìƒì„±
```

---

## ğŸ’¡ **ì–¸ì œ ë­˜ ì¨ì•¼ í• ê¹Œ?**

### âœ… **mergeë¥¼ ì¨ì•¼ í•  ë•Œ**

#### 1. ê´€ê³„í˜• ë°ì´í„° ì¡°ì¸
```python
# ê³ ê°ì •ë³´ + ì£¼ë¬¸ì •ë³´
customers = pd.DataFrame({
    'customer_id': [1, 2, 3],
    'name': ['í™ê¸¸ë™', 'ê¹€ì˜í¬', 'ë°•ì² ìˆ˜']
})

orders = pd.DataFrame({
    'customer_id': [1, 1, 2],
    'product': ['ë…¸íŠ¸ë¶', 'ë§ˆìš°ìŠ¤', 'í‚¤ë³´ë“œ'],
    'amount': [1200000, 30000, 80000]
})

# ê³ ê°ë³„ ì£¼ë¬¸ ë‚´ì—­ ì¡°ì¸
customer_orders = pd.merge(customers, orders, on='customer_id')
```

#### 2. ë§ˆìŠ¤í„°-ìƒì„¸ ë°ì´í„° ê²°í•©
```python
# ì œí’ˆë§ˆìŠ¤í„° + ê°€ê²©ì •ë³´
products = pd.DataFrame({
    'product_code': ['P001', 'P002'],
    'product_name': ['ë…¸íŠ¸ë¶', 'í‚¤ë³´ë“œ']
})

prices = pd.DataFrame({
    'product_code': ['P001', 'P002'],
    'price': [1200000, 80000]
})

product_info = pd.merge(products, prices, on='product_code')
```

### âœ… **concatì„ ì¨ì•¼ í•  ë•Œ**

#### 1. ê°™ì€ êµ¬ì¡° ë°ì´í„° í•©ì¹˜ê¸°
```python
# ì—¬ëŸ¬ ì§€ì  ë§¤ì¶œ ë°ì´í„° í•©ì¹˜ê¸°
seoul_sales = pd.DataFrame({'product': ['A', 'B'], 'sales': [100, 150]})
busan_sales = pd.DataFrame({'product': ['A', 'B'], 'sales': [80, 120]})

total_sales = pd.concat([seoul_sales, busan_sales], ignore_index=True)
```

#### 2. ì‹œê³„ì—´ ë°ì´í„° ê²°í•©
```python
# ì›”ë³„ ë°ì´í„°ë¥¼ ì—°ê°„ ë°ì´í„°ë¡œ
monthly_data = []
for month in range(1, 13):
    month_df = pd.read_csv(f'sales_{month:02d}.csv')
    monthly_data.append(month_df)

yearly_data = pd.concat(monthly_data, ignore_index=True)
```

#### 3. ì»¬ëŸ¼ í™•ì¥
```python
# ê¸°ì¡´ ë°ì´í„°ì— ìƒˆë¡œìš´ íŠ¹ì„± ì¶”ê°€
original_data = pd.DataFrame({'A': [1, 2], 'B': [3, 4]})
new_features = pd.DataFrame({'C': [5, 6], 'D': [7, 8]})

expanded_data = pd.concat([original_data, new_features], axis=1)
```

---

## ğŸš¨ **ì£¼ì˜ì‚¬í•­ ë° í”í•œ ì‹¤ìˆ˜**

### âŒ merge ì‹¤ìˆ˜ë“¤

#### 1. í‚¤ ì»¬ëŸ¼ ì—†ì´ merge
```python
# ì—ëŸ¬ ë°œìƒ!
# pd.merge(df1, df2)  # on íŒŒë¼ë¯¸í„° ì—†ìŒ
```

#### 2. í‚¤ ì»¬ëŸ¼ ì´ë¦„ ë‹¤ë¦„
```python
# í•´ê²°ì±…: left_on, right_on ì‚¬ìš©
result = pd.merge(df1, df2, left_on='id', right_on='student_id')
```

#### 3. ì¤‘ë³µ í‚¤ë¡œ ì¸í•œ ë°ì´í„° í­ì¦
```python
# ì¼ëŒ€ë‹¤ ê´€ê³„ì—ì„œ ì˜ˆìƒë³´ë‹¤ ë§ì€ í–‰ ìƒì„±
# ê²°ê³¼ í™•ì¸ í•„ìˆ˜: print(f"ì›ë³¸: {len(df1)} í–‰, ê²°ê³¼: {len(result)} í–‰")
```

### âŒ concat ì‹¤ìˆ˜ë“¤

#### 1. êµ¬ì¡°ê°€ ë‹¤ë¥¸ ë°ì´í„° concat
```python
# ë¬¸ì œ ìƒí™©
df1 = pd.DataFrame({'A': [1, 2]})
df2 = pd.DataFrame({'B': [3, 4]})  # ì»¬ëŸ¼ëª… ë‹¤ë¦„

# ê²°ê³¼: NaNì´ ë§ì´ ìƒê¹€
result = pd.concat([df1, df2])  # Aì»¬ëŸ¼ì— NaN, Bì»¬ëŸ¼ì— NaN

# í•´ê²°ì±…: ì»¬ëŸ¼ëª… í†µì¼
df2.columns = ['A']
result = pd.concat([df1, df2])
```

#### 2. ì¸ë±ìŠ¤ ì¤‘ë³µ
```python
# ì¸ë±ìŠ¤ê°€ ê²¹ì¹¨
df1 = pd.DataFrame({'A': [1, 2]}, index=[0, 1])
df2 = pd.DataFrame({'A': [3, 4]}, index=[0, 1])

# í•´ê²°ì±…: ignore_index=True
result = pd.concat([df1, df2], ignore_index=True)
```

---

## ğŸ¯ **ì‹¤ì „ ì˜ˆì œ: ì™„ì „í•œ ë°ì´í„° íŒŒì´í”„ë¼ì¸**

### ì‹œë‚˜ë¦¬ì˜¤: ì˜¨ë¼ì¸ ì‡¼í•‘ëª° ë¶„ì„

```python
# 1. ê¸°ë³¸ ë°ì´í„° ë¡œë“œ
customers = pd.DataFrame({
    'customer_id': [1, 2, 3, 4],
    'name': ['ê¹€ì² ìˆ˜', 'ì´ì˜í¬', 'ë°•ë¯¼ìˆ˜', 'ì •ì§€ì›'],
    'city': ['ì„œìš¸', 'ë¶€ì‚°', 'ì„œìš¸', 'ëŒ€êµ¬']
})

orders = pd.DataFrame({
    'order_id': [101, 102, 103, 104, 105],
    'customer_id': [1, 1, 2, 3, 5],  # 5ë²ˆ ê³ ê°ì€ customersì— ì—†ìŒ
    'product': ['ë…¸íŠ¸ë¶', 'ë§ˆìš°ìŠ¤', 'í‚¤ë³´ë“œ', 'ëª¨ë‹ˆí„°', 'í—¤ë“œì…‹'],
    'amount': [1200000, 30000, 80000, 300000, 150000]
})

products = pd.DataFrame({
    'product': ['ë…¸íŠ¸ë¶', 'ë§ˆìš°ìŠ¤', 'í‚¤ë³´ë“œ', 'ëª¨ë‹ˆí„°'],
    'category': ['ì „ìê¸°ê¸°', 'ì£¼ë³€ê¸°ê¸°', 'ì£¼ë³€ê¸°ê¸°', 'ì „ìê¸°ê¸°'],
    'cost': [900000, 15000, 40000, 200000]
})

# 2. mergeë¡œ ê´€ê³„í˜• ì¡°ì¸
# ê³ ê°-ì£¼ë¬¸ ì¡°ì¸ (ê³ ê° ì •ë³´ê°€ ìˆëŠ” ì£¼ë¬¸ë§Œ)
customer_orders = pd.merge(customers, orders, on='customer_id', how='inner')
print("ê³ ê°-ì£¼ë¬¸ ì¡°ì¸ ê²°ê³¼:")
print(customer_orders)

# ì£¼ë¬¸-ìƒí’ˆ ì¡°ì¸ (ëª¨ë“  ì£¼ë¬¸ ìœ ì§€, ìƒí’ˆ ì •ë³´ ì¶”ê°€)
order_details = pd.merge(orders, products, on='product', how='left')
print("\nì£¼ë¬¸-ìƒí’ˆ ì¡°ì¸ ê²°ê³¼:")
print(order_details)

# 3. concatìœ¼ë¡œ ì›”ë³„ ë°ì´í„° í•©ì¹˜ê¸°
jan_orders = orders[:2]  # 1ì›” ì£¼ë¬¸
feb_orders = orders[2:]  # 2ì›” ì£¼ë¬¸

# ì›”ë³„ ë¼ë²¨ ì¶”ê°€í•˜ê³  í•©ì¹˜ê¸°
jan_orders_labeled = jan_orders.copy()
jan_orders_labeled['month'] = '1ì›”'

feb_orders_labeled = feb_orders.copy()
feb_orders_labeled['month'] = '2ì›”'

all_orders = pd.concat([jan_orders_labeled, feb_orders_labeled], 
                      ignore_index=True)
print("\nì›”ë³„ ì£¼ë¬¸ í•©ì¹˜ê¸°:")
print(all_orders)

# 4. ìµœì¢… ë¶„ì„ìš© ë°ì´í„° ìƒì„±
final_analysis = pd.merge(
    pd.merge(customers, orders, on='customer_id', how='inner'),
    products, 
    on='product', 
    how='left'
)

print("\nìµœì¢… ë¶„ì„ ë°ì´í„°:")
print(final_analysis)

# ì´ìµë¥  ê³„ì‚°
final_analysis['profit'] = final_analysis['amount'] - final_analysis['cost']
final_analysis['profit_rate'] = (final_analysis['profit'] / 
                                final_analysis['amount'] * 100).round(2)

print("\nì´ìµ ë¶„ì„ ì¶”ê°€:")
print(final_analysis[['name', 'product', 'amount', 'profit', 'profit_rate']])
```

---

## ğŸ“Š **ì„±ëŠ¥ ë¹„êµ ë° ìµœì í™” íŒ**

### ì„±ëŠ¥ íŠ¹ì„±

```python
import time
import pandas as pd
import numpy as np

def performance_test():
    # í° ë°ì´í„°ì…‹ ìƒì„±
    n = 100000
    
    df1 = pd.DataFrame({
        'key': np.random.randint(0, n//10, n),
        'value1': np.random.randn(n)
    })
    
    df2 = pd.DataFrame({
        'key': np.random.randint(0, n//10, n),
        'value2': np.random.randn(n)
    })
    
    # merge ì„±ëŠ¥ ì¸¡ì •
    start = time.time()
    merged = pd.merge(df1, df2, on='key')
    merge_time = time.time() - start
    
    # concat ì„±ëŠ¥ ì¸¡ì • (ì„¸ë¡œ)
    start = time.time()
    concatenated = pd.concat([df1, df2], ignore_index=True)
    concat_time = time.time() - start
    
    print(f"Merge ì‹œê°„: {merge_time:.4f}ì´ˆ")
    print(f"Concat ì‹œê°„: {concat_time:.4f}ì´ˆ")
    print(f"Mergeê°€ {merge_time/concat_time:.2f}ë°° ëŠë¦¼")

# performance_test()
```

### ìµœì í™” íŒ

#### 1. merge ìµœì í™”
```python
# âœ… ì¸ë±ìŠ¤ ì„¤ì •ìœ¼ë¡œ ë¹ ë¥´ê²Œ
df1_indexed = df1.set_index('key')
df2_indexed = df2.set_index('key')
result = pd.merge(df1_indexed, df2_indexed, left_index=True, right_index=True)

# âœ… ì •ë ¬ëœ ë°ì´í„°ëŠ” ë” ë¹ ë¦„
df1_sorted = df1.sort_values('key')
df2_sorted = df2.sort_values('key')
```

#### 2. concat ìµœì í™”
```python
# âœ… ë¦¬ìŠ¤íŠ¸ë¡œ í•œ ë²ˆì—
dfs = [df1, df2, df3, df4]
result = pd.concat(dfs, ignore_index=True)

# âŒ ë£¨í”„ì—ì„œ ë°˜ë³µì ìœ¼ë¡œ concat (ë§¤ìš° ëŠë¦¼)
# result = df1
# for df in [df2, df3, df4]:
#     result = pd.concat([result, df])
```

---

## ğŸ¯ **ìš”ì•½: ì„ íƒ ê°€ì´ë“œ**

### ğŸ” **ì–¸ì œ merge?**
- ğŸ“Š **ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤** ìŠ¤íƒ€ì¼ ì¡°ì¸ì´ í•„ìš”í•  ë•Œ
- ğŸ”‘ **í‚¤ ì»¬ëŸ¼ ê¸°ì¤€**ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì—°ê²°í•´ì•¼ í•  ë•Œ  
- ğŸ“ˆ **ê³ ê°-ì£¼ë¬¸**, **ìƒí’ˆ-ê°€ê²©** ê°™ì€ ë§ˆìŠ¤í„°-ìƒì„¸ ê´€ê³„
- ğŸ¯ **íŠ¹ì • ì¡°ê±´**ìœ¼ë¡œ ë°ì´í„°ë¥¼ í•„í„°ë§í•˜ë©´ì„œ ì¡°ì¸

### ğŸ“š **ì–¸ì œ concat?**
- ğŸ“ **ê°™ì€ êµ¬ì¡°**ì˜ ë°ì´í„°ë¥¼ ë‹¨ìˆœíˆ í•©ì¹  ë•Œ
- ğŸ“… **ì‹œê³„ì—´ ë°ì´í„°** ì—°ê²° (ì›”ë³„â†’ì—°ê°„)
- ğŸ“‹ **ì—¬ëŸ¬ íŒŒì¼**ì„ í•˜ë‚˜ë¡œ í†µí•©
- â¡ï¸ **ì»¬ëŸ¼ í™•ì¥** (ìƒˆë¡œìš´ íŠ¹ì„± ì¶”ê°€)

### ğŸš€ **ë¹ ë¥¸ ê²°ì • ì²´í¬ë¦¬ìŠ¤íŠ¸**
1. **ë°ì´í„°ì— ê³µí†µ í‚¤ê°€ ìˆë‚˜?** â†’ merge ê³ ë ¤
2. **SQLì˜ JOINê³¼ ê°™ì€ ì‘ì—…?** â†’ merge
3. **ë‹¨ìˆœíˆ ë°ì´í„°ë¥¼ ìŒ“ê±°ë‚˜ ì˜†ìœ¼ë¡œ ë¶™ì´ê¸°?** â†’ concat  
4. **êµ¬ì¡°ê°€ ë™ì¼í•œ ì—¬ëŸ¬ ë°ì´í„°?** â†’ concat

---

**ğŸ‰ ì´ì œ mergeì™€ concatì„ ì™„ë²½í•˜ê²Œ êµ¬ë¶„í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!**