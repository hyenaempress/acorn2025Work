# 22.06.02 T검정 핵심요약 ⭐

## 🎯 집단 간 차이 분석 개요

**집단 간 차이 분석**은 평균 또는 비율의 차이를 분석하여 모집단의 특성을 추론하는 통계적 방법입니다.

### 🔍 T-test vs ANOVA 핵심 구분

| 구분 | T-test | ANOVA |
|------|--------|-------|
| **집단 수** | **2개 이하** | **3개 이상** |
| **검정통계량** | **T값** | **F값** |
| **활용** | 두 그룹 평균 차이 검정 | 여러 그룹 평균 차이 검정 |

---

## 💡 T검정의 핵심 아이디어

```
t = (집단 평균차이) / (집단 내 변동성)
```

- **분자**: 집단 간 차이가 얼마나 큰가?
- **분모**: 데이터의 불확실성(변동성)이 얼마나 큰가?

> **핵심**: 집단 평균차이가 데이터의 불확실성에 비해 얼마나 큰지를 계산하여 우연의 범위 내인지 판단

---

## 📊 t분포의 특징

### 🎯 언제 사용하나?
- **표본 평균**을 이용해 **정규분포의 평균**을 해석할 때
- **표본 크기가 30개 이하**일 때 (대개의 경우)
- **모집단 표준편차를 모를 때**

### 🔄 t분포의 진화
```
자유도 작음 → 완만한 분포 → t검정 사용
자유도 커짐 → 정규분포에 근접 → Z검정과 유사
```

---

## 🔬 T검정의 4가지 유형

### 1️⃣ **단일표본 t검정 (One-sample t-test)**

**목적**: 한 집단의 평균이 특정 값과 같은지 검정

```python
# 예시: 남성 집단의 평균키가 177cm인가?
import scipy.stats as stats

one_sample = [167.0, 182.7, 160.6, 176.8, 185.0]
result = stats.ttest_1samp(one_sample, popmean=177.0)
print(f'statistic: {result.statistic:.5f}, pvalue: {result.pvalue:.5f}')
```

**가설 설정**:
- H₀: 집단의 평균 키가 177cm이다
- H₁: 집단의 평균 키가 177cm가 아니다

---

### 2️⃣ **대응표본 t검정 (Paired t-test)**

**목적**: 같은 집단의 실험 전/후 차이 검정

**핵심 가정**: 
- 실험 후-실험 전 차이의 분포가 정규성을 따라야 함
- 정규성 위반 시 → **Wilcoxon signed rank test** 사용

```python
# 예시: 약물 복용 전후 혈압 차이
before = [120, 125, 130, 118, 135]
after = [115, 120, 125, 112, 128]

result = stats.ttest_rel(before, after)
print(f'대응표본 t검정: {result}')
```

**가설 설정**:
- H₀: 실험 전/후 간의 평균차이가 없다 (차이 = 0)
- H₁: 실험 전/후 간의 평균차이가 있다 (차이 ≠ 0)

---

### 3️⃣ **독립표본 t검정 (Independent t-test)**

**목적**: 두 독립된 집단의 평균 차이 검정

#### 🔍 3가지 필수 가정

| 가정 | 검정 방법 | 위반 시 대안 |
|------|----------|-------------|
| **1. 독립성** | 사람이 판단 | 대응표본 t검정 사용 |
| **2. 정규성** | Shapiro-Wilk test<br/>H₀: 정규분포를 따른다 | Mann-Whitney test |
| **3. 등분산성** | Levene test<br/>H₀: 두 집단의 분산은 같다 | Welch t-test |

```python
# 정규성 검정
stats.shapiro(data)  # p > 0.05면 정규성 만족

# 등분산성 검정  
stats.levene(group1, group2)  # p > 0.05면 등분산성 만족

# 독립표본 t검정
stats.ttest_ind(group1, group2, equal_var=True)  # 등분산 가정
stats.ttest_ind(group1, group2, equal_var=False)  # Welch t-test
```

**표본 크기별 가이드라인**:
- **n > 30**: 중심극한정리에 의해 정규성 만족
- **10 ≤ n ≤ 30**: Kolmogorov-Smirnov test 또는 Shapiro-Wilk test
- **n < 10**: 정규성 불만족, 비모수적 방법 사용

---

### 4️⃣ **보정된 t검정 (Adjusted t-test)**

**목적**: 다른 변수를 보정한 상태에서 집단 간 차이 검정

> 두 집단의 평균차이가 있더라도, 다른 변수까지 고려해서 보정한 후 검정하여 진짜 유의한 차이인지 확인

---

## 📊 실습 예제: 국어 점수 분석

### 🎯 연구 질문
중학교 1학년 1반 학생들의 국어 점수 평균이 80점인가?

```python
import pandas as pd
import scipy.stats as stats

# 데이터 로드
data = pd.read_csv("https://raw.githubusercontent.com/pykwon/python/refs/heads/master/testdata_utf8/student.csv")
print(f"국어 점수 평균: {data['국어'].mean():.1f}")  # 72.9점

# 1. 정규성 검정
shapiro_stat, shapiro_p = stats.shapiro(data.국어)
print(f"정규성 검정: statistic={shapiro_stat:.4f}, p-value={shapiro_p:.4f}")

# 2. 일표본 t검정
t_stat, t_p = stats.ttest_1samp(data['국어'], popmean=80)
print(f't검정: statistic={t_stat:.5f}, p-value={t_p:.5f}')

# 3. 비모수 검정 (정규성 위배 시)
wilcox_stat, wilcox_p = stats.wilcoxon(data.국어 - 80)
print(f'Wilcoxon 검정: statistic={wilcox_stat:.1f}, p-value={wilcox_p:.5f}')
```

### 📊 결과 해석

| 검정 방법 | 결과 | 해석 |
|----------|------|------|
| **정규성 검정** | p = 0.0129 < 0.05 | 정규성을 따르지 않음 |
| **t검정** | p = 0.199 > 0.05 | 귀무가설 채택 (평균 80과 차이 없음) |
| **Wilcoxon 검정** | p = 0.398 > 0.05 | 귀무가설 채택 (평균 80과 차이 없음) |

**결론**: 정규성 위배가 있지만 두 검정 모두 귀무가설을 기각하지 못함. 국어 점수 평균이 80점과 유의한 차이가 있다는 근거 부족.

---

## 🎯 핵심 통계 개념 정리

### 📈 분포별 특징

| 분포 | 용도 | 핵심 공식 | 언제 사용 |
|------|------|----------|----------|
| **Z분포** | 표준정규분포 | Z = (X-μ)/σ | 모표준편차 알 때 |
| **t분포** | 소표본 검정 | t = (x̄-μ)/(s/√n) | 모표준편차 모를 때 |
| **F분포** | 분산 비교 | F = s₁²/s₂² | 등분산성 검정, ANOVA |

### 🔄 자유도의 의미
- **물리학적**: 움직일 수 있는 독립적인 방향의 수
- **통계학적**: 자유롭게 변할 수 있는 값의 개수  
- **실무적**: 표본 크기 - 1 = n - 1

### 💡 검정통계량과 p-value의 관계
```
검정통계량이 커질수록 → p-value는 작아진다
p-value < 0.05 → 통계적으로 유의함 (귀무가설 기각)
```

---

## 🛠️ 실무 적용 팁

### ✅ **Do's (해야 할 것들)**

1. **여러 통계 방법으로 검증**: t-test, Wilcoxon, 정규성 검정을 모두 사용하여 근거를 명확히 함
2. **가정 확인**: 정규성, 등분산성, 독립성 검정을 먼저 수행
3. **적절한 검정 선택**: 데이터 특성에 맞는 검정 방법 선택
4. **효과 크기 고려**: 통계적 유의성과 실용적 중요성을 구분

### ❌ **Don'ts (하지 말아야 할 것들)**

1. **p-hacking**: 원하는 결과가 나올 때까지 여러 검정 시도
2. **가정 무시**: 정규성, 등분산성 확인 없이 바로 검정
3. **과도한 해석**: 유의하지 않다고 해서 차이가 없다고 단정
4. **표본 크기 무시**: 너무 작은 표본으로 일반화

---

## 🎓 마무리

T검정은 **집단 간 평균 차이**를 통계적으로 검정하는 핵심 도구입니다. 

**핵심 기억사항**:
- 평균차이와 변동성을 동시에 고려
- 표본 크기와 가정 확인이 중요  
- 정규성 위배 시 비모수 검정 활용
- 여러 방법으로 검증하여 신뢰성 확보

> **"통계는 문제를 풀다보면 해결된다"** - 이론보다는 실습을 통한 체득이 중요합니다!