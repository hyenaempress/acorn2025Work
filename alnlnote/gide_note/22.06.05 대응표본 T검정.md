# 22.06.04 대응표본 T검정 완전 가이드 ⭐

## 🎯 대응표본 T검정이란?

**대응표본 T검정(Paired Samples t-test)**은 **같은 대상**에 대해 **처리 전후**의 변화를 측정하여 그 차이가 통계적으로 유의한지 분석하는 방법입니다.

### 🔍 핵심 개념

**대응표본(Paired Sample)**:
- 동일한 관찰 대상으로부터 처리 이전과 이후를 **1:1로 대응**시킨 표본
- **같은 사람, 같은 개체**의 전후 비교
- 개체 간 차이를 제거하여 **순수한 처리 효과**만 측정

### 💡 독립표본 vs 대응표본

| 구분 | 독립표본 T검정 | 대응표본 T검정 |
|------|---------------|---------------|
| **대상** | 서로 다른 두 집단 | 같은 집단의 전후 비교 |
| **예시** | 남성 키 vs 여성 키 | 다이어트 전후 체중 |
| **장점** | 집단 간 특성 비교 | 개체차 제거로 민감한 검정 |
| **등분산성** | 검정 필요 | **검정 불필요** ⭐ |

---

## 🎯 언제 사용하나?

### 📋 대응표본 T검정 적용 상황

| 분야 | 예시 상황 | 측정 변수 |
|------|----------|-----------|
| **의학** | 약물 복용 전후 혈압 | 혈압 수치 |
| **교육** | 특강 전후 시험 점수 | 시험 점수 |
| **마케팅** | 광고 전후 상품 선호도 | 선호도 점수 |
| **심리학** | 치료 전후 우울증 점수 | 우울증 지수 |
| **의료** | 수술 전후 몸무게 변화 | 체중(kg) |

### ✅ 대응표본 T검정 조건

1. **동일 대상**: 같은 개체의 전후 측정
2. **연속형 데이터**: 차이값이 연속형
3. **정규성**: 차이값이 정규분포를 따름
4. **독립성**: 각 대응쌍이 독립적

### 🚨 주의: 등분산성 검정 불필요!
> **대응표본은 같은 개체 내 비교이므로 등분산성 검정이 필요 없습니다!**

---

## 💻 Python 구현

### 🔧 기본 문법
```python
import numpy as np
import scipy.stats as stats

# 대응표본 T검정
t_stat, p_value = stats.ttest_rel(before_data, after_data)

# 결과 해석
print(f"t-statistic: {t_stat:.4f}")
print(f"p-value: {p_value:.6f}")
if p_value < 0.05:
    print("✅ 통계적으로 유의한 차이 있음")
else:
    print("❌ 통계적으로 유의한 차이 없음")
```

---

## 🎓 실습 1: 특강 효과 분석

### 📚 문제 상황
4강의실 학생 30명을 대상으로 특강이 시험 점수에 영향을 주는가?

```python
import numpy as np
import scipy.stats as stats
import matplotlib.pyplot as plt

# 가설 설정
# H₀: 특강 전후의 시험점수는 차이가 없다
# H₁: 특강 전후의 시험점수는 차이가 있다

# 데이터 생성
np.random.seed(123)
before_lecture = np.random.normal(75, 10, 30)  # 특강 전 점수
after_lecture = np.random.normal(80, 10, 30)   # 특강 후 점수

print("📊 기술통계")
print(f"특강 전 평균: {np.mean(before_lecture):.2f}점")
print(f"특강 후 평균: {np.mean(after_lecture):.2f}점")
print(f"평균 차이: {np.mean(after_lecture) - np.mean(before_lecture):.2f}점")

# 차이값 계산
difference = after_lecture - before_lecture
print(f"\n차이값 평균: {np.mean(difference):.2f}점")
print(f"차이값 표준편차: {np.std(difference, ddof=1):.2f}점")
```

### 🔍 정규성 검정
```python
print("\n🔍 정규성 검정")
print("-" * 40)

# 각 그룹의 정규성
shapiro_before = stats.shapiro(before_lecture)
shapiro_after = stats.shapiro(after_lecture)
shapiro_diff = stats.shapiro(difference)

print(f"특강 전 정규성: p = {shapiro_before[1]:.6f}")
print(f"특강 후 정규성: p = {shapiro_after[1]:.6f}")
print(f"차이값 정규성: p = {shapiro_diff[1]:.6f} ⭐ 중요!")

if shapiro_diff[1] > 0.05:
    print("✅ 차이값이 정규분포 → 대응표본 T검정 적합")
else:
    print("❌ 차이값이 비정규분포 → Wilcoxon signed-rank 고려")
```

### 📊 대응표본 T검정 수행
```python
print("\n📊 대응표본 T검정 결과")
print("-" * 40)

t_stat, p_value = stats.ttest_rel(before_lecture, after_lecture)

print(f"T-statistic: {t_stat:.6f}")
print(f"P-value: {p_value:.6f}")
print(f"자유도: {len(before_lecture) - 1}")

# 결론
alpha = 0.05
if p_value < alpha:
    print(f"\n✅ 결론: p({p_value:.6f}) < α({alpha})")
    print("→ 귀무가설 기각, 특강 전후 점수에 유의한 차이 있음")
    if t_stat > 0:
        print("→ 특강 후 점수가 유의하게 높음")
    else:
        print("→ 특강 후 점수가 유의하게 낮음")
else:
    print(f"\n❌ 결론: p({p_value:.6f}) ≥ α({alpha})")
    print("→ 귀무가설 채택, 특강 효과 없음")
```

### 🎨 시각화
```python
# 시각화
fig, (ax1, ax2, ax3) = plt.subplots(1, 3, figsize=(15, 5))

# 1. 전후 비교 박스플롯
ax1.boxplot([before_lecture, after_lecture], 
           labels=['특강 전', '특강 후'],
           patch_artist=True)
ax1.set_title('특강 전후 점수 비교')
ax1.set_ylabel('점수')
ax1.grid(True, alpha=0.3)

# 2. 개별 학생 변화 (선그래프)
for i in range(len(before_lecture)):
    ax2.plot([0, 1], [before_lecture[i], after_lecture[i]], 
            'o-', alpha=0.6, linewidth=1, markersize=4)

# 평균선 강조
ax2.plot([0, 1], [np.mean(before_lecture), np.mean(after_lecture)], 
         'ro-', linewidth=3, markersize=8, label='평균')
ax2.set_xticks([0, 1])
ax2.set_xticklabels(['특강 전', '특강 후'])
ax2.set_ylabel('점수')
ax2.set_title('개별 학생 점수 변화')
ax2.legend()
ax2.grid(True, alpha=0.3)

# 3. 차이값 히스토그램
ax3.hist(difference, bins=10, alpha=0.7, color='lightgreen', 
         edgecolor='black')
ax3.axvline(0, color='red', linestyle='--', linewidth=2, 
           label='변화 없음 (H₀)')
ax3.axvline(np.mean(difference), color='blue', linestyle='-', linewidth=2,
           label=f'평균 차이: {np.mean(difference):.2f}')
ax3.set_xlabel('점수 차이 (특강 후 - 특강 전)')
ax3.set_ylabel('빈도')
ax3.set_title('점수 변화량 분포')
ax3.legend()
ax3.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()
```

**실습 1 결과**: p = 0.083 > 0.05 → 특강 효과 없음

---

## 🏥 실습 2: 복부 수술 효과 분석

### 📋 문제 상황
환자 9명의 복부 수술 전후 몸무게 변화 분석

```python
# 가설 설정
# H₀: 복부 수술 전후의 몸무게 변화는 없다
# H₁: 복부 수술은 몸무게 변화에 영향을 준다

# 실제 데이터
baseline = [67.2, 67.4, 71.5, 77.6, 86.0, 89.1, 59.5, 81.9, 105.5]  # 수술 전
follow_up = [62.4, 64.6, 70.4, 62.6, 80.1, 73.2, 58.2, 71.0, 101.0]  # 수술 후

print("🏥 복부 수술 전후 몸무게 분석")
print("=" * 40)

# 기술통계
print(f"수술 전 평균 몸무게: {np.mean(baseline):.2f}kg")
print(f"수술 후 평균 몸무게: {np.mean(follow_up):.2f}kg")

# 차이값 계산 (수술 전 - 수술 후, 양수면 체중 감소)
weight_change = np.array(baseline) - np.array(follow_up)
print(f"평균 체중 변화: {np.mean(weight_change):.2f}kg")

# 개별 환자 변화
print(f"\n👥 개별 환자 체중 변화:")
for i, (before, after, change) in enumerate(zip(baseline, follow_up, weight_change)):
    direction = "감소" if change > 0 else "증가"
    print(f"환자 {i+1}: {before:.1f}kg → {after:.1f}kg ({change:+.1f}kg {direction})")

# 체중 감소/증가한 환자 수
decreased = sum(1 for x in weight_change if x > 0)
increased = sum(1 for x in weight_change if x < 0)
no_change = sum(1 for x in weight_change if x == 0)

print(f"\n📈 요약:")
print(f"체중 감소: {decreased}명, 체중 증가: {increased}명, 변화 없음: {no_change}명")
```

### 🔍 대응표본 T검정 수행
```python
# 대응표본 T검정
t_stat, p_value = stats.ttest_rel(baseline, follow_up)

print(f"\n📊 대응표본 T검정 결과")
print("-" * 40)
print(f"T-statistic: {t_stat:.6f}")
print(f"P-value: {p_value:.6f}")
print(f"자유도: {len(baseline) - 1}")

# 효과크기 계산 (Cohen's d)
mean_diff = np.mean(weight_change)
std_diff = np.std(weight_change, ddof=1)
cohens_d = mean_diff / std_diff
print(f"Cohen's d (효과크기): {cohens_d:.3f}")

# 결론
if p_value < 0.05:
    print(f"\n✅ 결론: p({p_value:.6f}) < 0.05")
    print("→ 귀무가설 기각, 수술 전후 체중에 유의한 차이 있음")
    print(f"→ 평균 {mean_diff:.2f}kg 체중 감소")
else:
    print(f"\n❌ 결론: p({p_value:.6f}) ≥ 0.05")
    print("→ 귀무가설 채택, 수술로 인한 체중 변화 없음")
```

**실습 2 결과**: p = 0.006 < 0.05 → 수술로 인한 유의한 체중 감소

---

## 📝 실습 3: 중간고사 vs 기말고사

### 🎓 문제 4 상황
학급의 중간고사와 기말고사 성적 비교 - 학업능력 변화 여부 확인

```python
# 가설 설정
# H₀: 중간고사와 기말고사 성적은 차이가 없다 (학업능력 변화 없음)
# H₁: 중간고사와 기말고사 성적은 차이가 있다 (학업능력 변화 있음)

# 데이터 (학생 번호 순)
midterm = [80, 75, 85, 50, 60, 75, 45, 70, 90, 95, 85, 80]  # 중간고사
final = [90, 70, 90, 65, 80, 85, 65, 75, 80, 90, 95, 95]    # 기말고사

print("🎓 중간고사 vs 기말고사 성적 분석")
print("=" * 40)

# 기술통계
print(f"중간고사 평균: {np.mean(midterm):.2f}점")
print(f"기말고사 평균: {np.mean(final):.2f}점")

# 성적 향상 분석
improvement = np.array(final) - np.array(midterm)
print(f"평균 점수 변화: {np.mean(improvement):.2f}점")

# 개별 학생 분석
print(f"\n👥 개별 학생 성적 변화:")
improved = 0
declined = 0
same = 0

for i, (mid, fin, change) in enumerate(zip(midterm, final, improvement)):
    if change > 0:
        status = "향상"
        improved += 1
    elif change < 0:
        status = "하락"
        declined += 1
    else:
        status = "동일"
        same += 1
    
    print(f"학생 {i+1:2d}: {mid:2d}점 → {fin:2d}점 ({change:+2d}점 {status})")

print(f"\n📈 종합:")
print(f"성적 향상: {improved}명, 성적 하락: {declined}명, 변화 없음: {same}명")
```

### 🔬 완전한 분석 수행
```python
def complete_paired_analysis(before, after, test_name="대응표본 T검정"):
    """완전한 대응표본 분석 함수"""
    
    print(f"\n🔍 {test_name} 완전 분석")
    print("=" * 50)
    
    # 1단계: 차이값 계산
    difference = np.array(after) - np.array(before)
    
    print("📊 기술통계:")
    print(f"   사전 평균: {np.mean(before):.2f}")
    print(f"   사후 평균: {np.mean(after):.2f}")
    print(f"   차이 평균: {np.mean(difference):.2f}")
    print(f"   차이 표준편차: {np.std(difference, ddof=1):.2f}")
    
    # 2단계: 정규성 검정 (차이값)
    shapiro_stat, shapiro_p = stats.shapiro(difference)
    print(f"\n🔍 차이값 정규성 검정:")
    print(f"   Shapiro-Wilk p-value: {shapiro_p:.6f}")
    
    if shapiro_p > 0.05:
        print("   ✅ 차이값이 정규분포 → 대응표본 T검정 적합")
        use_parametric = True
    else:
        print("   ❌ 차이값이 비정규분포 → Wilcoxon signed-rank 권장")
        use_parametric = False
    
    # 3단계: 검정 수행
    if use_parametric:
        t_stat, p_value = stats.ttest_rel(before, after)
        print(f"\n📊 대응표본 T검정 결과:")
        print(f"   T-statistic: {t_stat:.6f}")
        test_method = "대응표본 T검정"
    else:
        # Wilcoxon signed-rank test
        wilcox_stat, p_value = stats.wilcoxon(before, after)
        print(f"\n🔄 Wilcoxon signed-rank 검정 결과:")
        print(f"   Wilcoxon statistic: {wilcox_stat:.1f}")
        test_method = "Wilcoxon 검정"
    
    print(f"   P-value: {p_value:.6f}")
    print(f"   자유도: {len(before) - 1}")
    
    # 4단계: 효과크기 계산
    cohens_d = np.mean(difference) / np.std(difference, ddof=1)
    print(f"   Cohen's d: {cohens_d:.3f}")
    
    if abs(cohens_d) < 0.2:
        effect_size = "작은 효과"
    elif abs(cohens_d) < 0.5:
        effect_size = "중간 효과"  
    else:
        effect_size = "큰 효과"
    
    print(f"   효과크기: {effect_size}")
    
    # 5단계: 결론
    print(f"\n🎯 결론 ({test_method}):")
    if p_value < 0.05:
        print(f"   ✅ p({p_value:.6f}) < 0.05 → 유의한 차이 있음")
        if np.mean(difference) > 0:
            print("   → 사후 점수가 사전보다 유의하게 높음")
        else:
            print("   → 사후 점수가 사전보다 유의하게 낮음")
    else:
        print(f"   ❌ p({p_value:.6f}) ≥ 0.05 → 유의한 차이 없음")
        print("   → 처리 효과 없음")
    
    return {
        'method': test_method,
        'statistic': t_stat if use_parametric else wilcox_stat,
        'p_value': p_value,
        'cohens_d': cohens_d,
        'conclusion': 'significant' if p_value < 0.05 else 'not_significant'
    }

# 실습 3 완전 분석
result = complete_paired_analysis(midterm, final, "중간고사 vs 기말고사")
```

---

## 🔍 대응표본 T검정 vs 독립표본 T검정

### 📊 같은 데이터, 다른 해석

```python
def compare_tests_demo():
    """대응표본 vs 독립표본 비교 데모"""
    
    # 같은 데이터로 두 검정 비교
    before = [80, 75, 85, 50, 60, 75, 45, 70, 90, 95, 85, 80]
    after = [90, 70, 90, 65, 80, 85, 65, 75, 80, 90, 95, 95]
    
    print("🆚 대응표본 vs 독립표본 T검정 비교")
    print("=" * 50)
    
    # 1. 대응표본 T검정 (올바른 방법)
    t_paired, p_paired = stats.ttest_rel(before, after)
    print(f"📊 대응표본 T검정:")
    print(f"   T-statistic: {t_paired:.6f}")
    print(f"   P-value: {p_paired:.6f}")
    print(f"   결론: {'유의함' if p_paired < 0.05 else '유의하지 않음'}")
    
    # 2. 독립표본 T검정 (잘못된 방법)
    t_indep, p_indep = stats.ttest_ind(before, after)
    print(f"\n❌ 독립표본 T검정 (잘못된 적용):")
    print(f"   T-statistic: {t_indep:.6f}")
    print(f"   P-value: {p_indep:.6f}")
    print(f"   결론: {'유의함' if p_indep < 0.05 else '유의하지 않음'}")
    
    print(f"\n💡 차이점:")
    print(f"   대응표본: 개체 내 변화에 집중 (더 민감한 검정)")
    print(f"   독립표본: 개체 간 차이까지 포함 (덜 민감한 검정)")
    print(f"   → 같은 데이터도 다른 결과 가능!")

compare_tests_demo()
```

---

## 🚨 주의사항 및 가정

### ⚠️ 대응표본 T검정 가정

```python
def check_paired_assumptions(before, after):
    """대응표본 T검정 가정 확인"""
    
    print("🔍 대응표본 T검정 가정 확인")
    print("=" * 40)
    
    # 1. 표본 크기 동일성
    if len(before) != len(after):
        print("❌ 치명적 오류: 전후 데이터 크기가 다름!")
        return False
    else:
        print(f"✅ 표본 크기: 전후 모두 {len(before)}개")
    
    # 2. 차이값의 정규성
    difference = np.array(after) - np.array(before)
    _, shapiro_p = stats.shapiro(difference)
    
    print(f"🔍 차이값 정규성: p = {shapiro_p:.6f}")
    if shapiro_p > 0.05:
        print("✅ 차이값이 정규분포를 따름")
        normal = True
    else:
        print("❌ 차이값이 정규분포를 위배함")
        print("   → Wilcoxon signed-rank test 고려")
        normal = False
    
    # 3. 독립성 (시각적 확인)
    print("🔍 독립성: 연구 설계로 판단")
    print("   ✅ 각 대응쌍이 독립적이어야 함")
    
    # 4. 이상치 확인
    q1, q3 = np.percentile(difference, [25, 75])
    iqr = q3 - q1
    lower_bound = q1 - 1.5 * iqr
    upper_bound = q3 + 1.5 * iqr
    
    outliers = [(i, diff) for i, diff in enumerate(difference) 
                if diff < lower_bound or diff > upper_bound]
    
    if outliers:
        print(f"⚠️ 이상치 발견: {len(outliers)}개")
        for idx, value in outliers:
            print(f"   대상 {idx+1}: 차이값 {value:.2f}")
    else:
        print("✅ 이상치 없음")
    
    return normal

# 가정 확인 예시
check_paired_assumptions(midterm, final)
```

### 🔄 정규성 위배 시 대안

```python
def paired_test_alternatives(before, after):
    """정규성 위배 시 대안 검정들"""
    
    print("🔄 정규성 위배 시 대안들")
    print("=" * 30)
    
    difference = np.array(after) - np.array(before)
    
    # 1. 데이터 변환
    print("1️⃣ 데이터 변환:")
    
    # 로그 변환 (양수일 때만)
    if all(d > 0 for d in difference):
        log_diff = np.log(difference)
        _, log_p = stats.shapiro(log_diff)
        print(f"   로그 변환 후 정규성: p = {log_p:.6f}")
    
    # 제곱근 변환
    if all(d >= 0 for d in difference):
        sqrt_diff = np.sqrt(np.abs(difference))
        _, sqrt_p = stats.shapiro(sqrt_diff)
        print(f"   제곱근 변환 후 정규성: p = {sqrt_p:.6f}")
    
    # 2. Wilcoxon signed-rank test
    print(f"\n2️⃣ Wilcoxon signed-rank test:")
    wilcox_stat, wilcox_p = stats.wilcoxon(before, after)
    print(f"   Wilcoxon statistic: {wilcox_stat:.1f}")
    print(f"   P-value: {wilcox_p:.6f}")
    
    # 3. 부트스트랩 (고급)
    print(f"\n3️⃣ 부트스트랩 검정 (고급):")
    print(f"   표본 크기가 클 때(n>30) 중심극한정리 활용 가능")

# 대안 검정 예시  
paired_test_alternatives(midterm, final)
```

---

## 📊 완벽한 대응표본 분석 템플릿

```python
def paired_ttest_complete_template(before_data, after_data, 
                                 test_name="대응표본 T검정", 
                                 alpha=0.05):
    """완벽한 대응표본 T검정 템플릿"""
    
    print(f"🔬 {test_name} 완전 분석 보고서")
    print("=" * 60)
    
    # 0. 데이터 검증
    if len(before_data) != len(after_data):
        print("❌ 오류: 전후 데이터 크기가 다릅니다!")
        return None
    
    before = np.array(before_data)
    after = np.array(after_data)
    difference = after - before
    n = len(before)
    
    # 1. 기술통계
    print("📊 1. 기술통계")
    print("-" * 30)
    print(f"   표본 크기: {n}")
    print(f"   사전 측정: 평균 {np.mean(before):.3f}, 표준편차 {np.std(before, ddof=1):.3f}")
    print(f"   사후 측정: 평균 {np.mean(after):.3f}, 표준편차 {np.std(after, ddof=1):.3f}")
    print(f"   차이값: 평균 {np.mean(difference):.3f}, 표준편차 {np.std(difference, ddof=1):.3f}")
    
    # 2. 가정 검정
    print(f"\n🔍 2. 가정 검정")
    print("-" * 30)
    
    # 정규성 검정 (차이값)
    shapiro_stat, shapiro_p = stats.shapiro(difference)
    print(f"   정규성 검정 (차이값): p = {shapiro_p:.6f}")
    
    normality_satisfied = shapiro_p > alpha
    if normality_satisfied:
        print("   ✅ 정규성 가정 만족")
    else:
        print("   ❌ 정규성 가정 위배")
    
    # 3. 검정 수행
    print(f"\n📊 3. 통계 검정")
    print("-" * 30)
    
    if normality_satisfied:
        # 대응표본 T검정
        t_stat, p_value = stats.ttest_rel(before, after)
        test_method = "대응표본 T검정"
        print(f"   검정 방법: {test_method}")
        print(f"   T-statistic: {t_stat:.6f}")
        print(f"   자유도: {n-1}")
    else:
        # Wilcoxon signed-rank test  
        wilcox_stat, p_value = stats.wilcoxon(before, after)
        test_method = "Wilcoxon signed-rank 검정"
        print(f"   검정 방법: {test_method}")
        print(f"   Wilcoxon statistic: {wilcox_stat:.1f}")
    
    print(f"   P-value: {p_value:.6f}")
    
    # 4. 효과크기
    print(f"\n📏 4. 효과크기")
    print("-" * 30)
    
    cohens_d = np.mean(difference) / np.std(difference, ddof=1)
    print(f"   Cohen's d: {cohens_d:.3f}")
    
    if abs(cohens_d) < 0.2:
        effect_interpretation = "작은 효과"
    elif abs(cohens_d) < 0.5:
        effect_interpretation = "중간 효과"
    else:
        effect_interpretation = "큰 효과"
    
    print(f"   해석: {effect_interpretation}")
    
    # 5. 신뢰구간
    print(f"\n📐 5. 95% 신뢰구간")
    print("-" * 30)
    
    se_diff = stats.sem(difference)
    ci_margin = stats.t.ppf(1 - alpha/2, n-1) * se_diff
    ci_lower = np.mean(difference) - ci_margin
    ci_upper = np.mean(difference) + ci_margin
    
    print(f"   차이의 평균: {np.mean(difference):.3f}")
    print(f"   95% 신뢰구간: [{ci_lower:.3f}, {ci_upper:.3f}]")
    
    if ci_lower > 0:
        ci_interpretation = "사후 측정이 일관되게 높음"
    elif ci_upper < 0:
        ci_interpretation = "사전 측정이 일관되게 높음"
    else:
        ci_interpretation = "차이가 0을 포함 (불확실)"
    
    print(f"   해석: {ci_interpretation}")
    
    # 6. 최종 결론
    print(f"\n🎯 6. 최종 결론")
    print("-" * 30)
    
    if p_value < alpha:
        significance = "통계적으로 유의함"
        print(f"   ✅ p({p_value:.6f}) < α({alpha}) → {significance}")
        
        if np.mean(difference) > 0:
            direction = "사후 측정값이 사전보다 유의하게 높음"
        else:
            direction = "사후 측정값이 사전보다 유의하게 낮음"
        print(f"   → {direction}")
        
    else:
        significance = "통계적으로 유의하지 않음"
        print(f"   ❌ p({p_value:.6f}) ≥ α({alpha}) → {significance}")
        print(f"   → 처리 전후에 의미있는 변화 없음")
    
    # 7. 추가 정보
    improved_count = sum(1 for d in difference if d > 0)
    declined_count = sum(1 for d in difference if d < 0)
    no_change_count = sum(1 for d in difference if d == 0)
    
    print(f"\n📈 7. 개별 변화 요약")
    print("-" * 30)
    print(f"   향상: {improved_count}명 ({improved_count/n*100:.1f}%)")
    print(f"   하락: {declined_count}명 ({declined_count/n*100:.1f}%)")
    print(f"   변화없음: {no_change_count}명 ({no_change_count/n*100:.1f}%)")
    
    return {
        'method': test_method,
        'p_value': p_value,
        'cohens_d': cohens_d,
        'confidence_interval': (ci_lower, ci_upper),
        'conclusion': significance
    }

# 템플릿 사용 예시
result = paired_ttest_complete_template(
    midterm, final, 
    "중간고사 vs 기말고사 분석"
)
```

---

## 🏆 대응표본 T검정 마스터 체크리스트

### ✅ 완전 정복 확인 목록

#### 🎯 개념 이해
- [ ] **대응표본의 정의**: 같은 개체의 전후 비교
- [ ] **독립표본과의 차이**: 개체 간 vs 개체 내 비교
- [ ] **등분산성 불필요**: 같은 개체 내 비교이므로
- [ ] **차이값 정규성**: 핵심 가정 이해

#### 🔧 실무 적용  
- [ ] **가설 설정**: H₀ vs H₁ 올바른 설정
- [ ] **Python 구현**: `stats.ttest_rel()` 숙련 사용
- [ ] **정규성 검정**: 차이값의 Shapiro-Wilk 검정
- [ ] **대안 검정**: Wilcoxon signed-rank 활용

#### 📊 결과 해석
- [ ] **P-value 해석**: 유의성 판단
- [ ] **효과크기**: Cohen's d 계산 및 해석  
- [ ] **신뢰구간**: 차이의 범위 추정
- [ ] **실무적 의미**: 통계적 vs 실무적 중요성 구분

#### 🎨 시각화 및 보고
- [ ] **전후 비교 그래프**: 박스플롯, 선그래프
- [ ] **차이값 분포**: 히스토그램
- [ ] **완전한 보고서**: 템플릿 활용
- [ ] **결론 도출**: 비즈니스 인사이트 제시

---

## 🎉 실무 활용 예시

### 💼 다양한 분야 적용

```python
# 의학 연구
before_bp = [140, 135, 142, 138, 145]  # 약물 복용 전 혈압
after_bp = [130, 128, 135, 132, 140]   # 약물 복용 후 혈압

# 교육 효과
before_score = [60, 65, 70, 55, 80]    # 특강 전 점수
after_score = [70, 75, 85, 65, 90]     # 특강 후 점수

# 마케팅 효과
before_preference = [3, 4, 2, 5, 3]    # 광고 전 선호도
after_preference = [4, 5, 4, 5, 4]     # 광고 후 선호도

# 한 번에 여러 분석
datasets = [
    (before_bp, after_bp, "약물 효과 분석"),
    (before_score, after_score, "교육 효과 분석"), 
    (before_preference, after_preference, "광고 효과 분석")
]

for before, after, name in datasets:
    print(f"\n{'='*20} {name} {'='*20}")
    paired_ttest_complete_template(before, after, name)
```

---

## 💡 핵심 포인트 정리

### 🔥 **반드시 기억할 것들**

1. **대응표본 = 같은 개체의 전후 비교**
2. **차이값의 정규성이 핵심 가정**
3. **등분산성 검정은 불필요** (독립표본과 차이점)
4. **개체 간 차이 제거로 더 민감한 검정**
5. **정규성 위배 시 Wilcoxon signed-rank 사용**

### 🎯 **실무에서 이렇게 사용하세요**

```python
# 간단한 실무 함수
def quick_paired_test(before, after, test_name="대응표본 검정"):
    """빠른 대응표본 검정"""
    
    # 차이값 정규성 확인
    diff = np.array(after) - np.array(before)
    _, norm_p = stats.shapiro(diff)
    
    if norm_p > 0.05:
        # T검정
        stat, p = stats.ttest_rel(before, after)
        method = "대응표본 T검정"
    else:
        # Wilcoxon 검정
        stat, p = stats.wilcoxon(before, after)
        method = "Wilcoxon 검정"
    
    result = "유의함" if p < 0.05 else "유의하지 않음"
    
    print(f"🔍 {test_name}")
    print(f"   방법: {method}")
    print(f"   통계량: {stat:.3f}")
    print(f"   P-value: {p:.6f}")
    print(f"   결론: {result}")
    
    return p < 0.05

# 사용 예시
quick_paired_test(midterm, final, "학업 성취도 변화")
```

---

## 🎓 마무리

**축하합니다! 대응표본 T검정을 완전히 마스터했습니다!** 🎉

이제 여러분은:
- ✨ **전후 비교의 정확한 분석**을 할 수 있습니다
- 🔧 **적절한 검정법을 선택**할 수 있습니다  
- 📊 **완벽한 분석 보고서를 작성**할 수 있습니다
- 💼 **실무에서 바로 활용**할 수 있습니다

### 🚀 다음 단계: 고급 통계 기법
- **ANOVA**: 3개 이상 그룹 비교
- **반복측정 ANOVA**: 대응표본의 확장
- **다변량 분석**: 여러 변수 동시 분석
- **혼합효과모델**: 복잡한 반복측정 설계

**대응표본 T검정 마스터가 되신 것을 축하드립니다!** 🏆✨