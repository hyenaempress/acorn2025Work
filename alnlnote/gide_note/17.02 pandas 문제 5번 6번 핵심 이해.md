# 📊 판다스 문제 5, 6번 완전 해결 가이드

## 🎯 문제 5: 타이타닉 데이터 분석

### 📋 데이터 준비
```python
import pandas as pd
import numpy as np

# 타이타닉 데이터 읽기 (헤더 없음)
df = pd.read_csv('titanic_data.csv', header=None)

# 열 구조 이해
# 0: Survived (0=사망, 1=생존)
# 1: Pclass (1=1등석, 2=2등석, 3=3등석)  
# 2: Sex (male=남성, female=여성)
# 3: Age (나이)
# 기타: SibSp, Parch, Ticket, Fare, Cabin, Embarked

print("데이터 기본 정보:")
print(f"크기: {df.shape}")
print(df.head())
```

### 🔪 문제 5-1: cut() 함수로 나이대별 생존자 수 계산

```python
# 1) 나이대 구간 설정
bins = [1, 20, 35, 60, 150]
labels = ["소년", "청년", "장년", "노년"]

# 2) cut() 함수로 나이대 구분
age_groups = pd.cut(df[3], bins=bins, labels=labels)
print("나이대 구분 결과:")
print(age_groups.value_counts())

# 3) 나이대별 생존자 수 계산
survival_by_age = df.groupby(age_groups)[0].sum()
print("\n📊 나이대별 생존자 수:")
print(survival_by_age)

# 4) 더 자세한 분석 (보너스)
age_analysis = df.groupby(age_groups).agg({
    0: ['count', 'sum']  # 총 인원, 생존자 수
}).round(2)
age_analysis.columns = ['총_인원', '생존자_수']
age_analysis['생존율'] = (age_analysis['생존자_수'] / age_analysis['총_인원'] * 100).round(1)
print("\n📈 나이대별 상세 분석:")
print(age_analysis)
```

**💡 cut() 함수 핵심 포인트:**
- `bins = [1, 20, 35, 60, 150]`: 구간 경계값
- `(1, 20]`: 1초과 20이하 → 소년
- `(20, 35]`: 20초과 35이하 → 청년
- 결측치(NaN)는 자동으로 제외됨

### 🗂️ 문제 5-2: pivot_table()로 생존율 분석

#### 📊 2-1) 성별 × 승선등급별 생존율
```python
# 기본 피봇테이블 생성
pivot1 = df.pivot_table(
    values=0,        # 생존 여부 (0열)
    index=2,         # 성별 (2열) - 행
    columns=1,       # 승선등급 (1열) - 열
    aggfunc='mean'   # 평균 = 생존율
)

print("📊 성별 × 승선등급별 생존율:")
print(pivot1)
print("\n백분율로 표시:")
print((pivot1 * 100).round(2))
```

#### 📊 2-2) 성별 + 나이대 × 승선등급별 생존율 
```python
# 나이대를 데이터프레임에 추가
df['age_group'] = pd.cut(df[3], bins=bins, labels=labels)

# 다중 인덱스 피봇테이블
pivot2 = df.pivot_table(
    values=0,                    # 생존 여부
    index=[2, 'age_group'],      # 성별 + 나이대 (다중 인덱스)
    columns=1,                   # 승선등급
    aggfunc='mean'               # 생존율
)

print("📊 성별 + 나이대 × 승선등급별 생존율:")
print("백분율 표시 (소수 둘째자리):")
print((pivot2 * 100).round(2))
```

**💡 pivot_table() 핵심 파라미터:**
- `values`: 집계할 값
- `index`: 행에 배치할 변수 (리스트로 다중 인덱스 가능)
- `columns`: 열에 배치할 변수
- `aggfunc='mean'`: 평균 계산 (생존율)

## 🗃️ 문제 6: CSV 파일 처리

### 📁 문제 6-1: human.csv 처리

```python
# 1) 파일 읽기 및 기본 확인
df_human = pd.read_csv('human.csv')
print("📋 human.csv 기본 정보:")
print(f"크기: {df_human.shape}")
print(f"열 이름: {list(df_human.columns)}")
print("\n처음 5행:")
print(df_human.head())

# 2) 결측치 확인
print("\n결측치 현황:")
print(df_human.isnull().sum())

# 3) Group이 NA인 행 삭제
print(f"\n🔥 Group NA 처리:")
print(f"처리 전 행 수: {len(df_human)}")

df_clean = df_human.dropna(subset=['Group'])  # Group 열의 NA만 체크
print(f"처리 후 행 수: {len(df_clean)}")
print(f"삭제된 행 수: {len(df_human) - len(df_clean)}")

# 4) Career, Score 열만 추출
df_subset = df_clean[['Career', 'Score']]
print(f"\n📊 추출된 데이터 (크기: {df_subset.shape}):")
print(df_subset.head())

# 5) 평균 계산
means = df_subset.mean()
print(f"\n📈 Career, Score 평균:")
print(means)
```

**🧹 strip() 함수 활용법:**
```python
# strip() 함수 예시
messy_data = [
    "  홍길동  \n",      # 앞뒤 공백 + 줄바꿈
    "\t김철수\n  ",       # 탭 + 줄바꿈 + 공백
    "  \n이영희  ",       # 공백 + 줄바꿈
    "박민수\t\n"          # 탭 + 줄바꿈
]

print("🧹 strip() 함수 효과:")
for i, data in enumerate(messy_data, 1):
    print(f"{i}. 원본: {repr(data)}")     # repr()로 숨겨진 문자 확인
    print(f"   정제: {repr(data.strip())}")  # strip() 적용 결과

# DataFrame 전체 문자열 열 정제
def clean_string_columns(df, columns):
    """문자열 열들을 strip으로 정제"""
    df_copy = df.copy()
    for col in columns:
        if df_copy[col].dtype == 'object':
            df_copy[col] = df_copy[col].astype(str).str.strip()
    return df_copy
```

### 📊 문제 6-2: tips.csv 분석

```python
# 1) 파일 읽기
df_tips = pd.read_csv('tips.csv')

# 2) 파일 정보 확인
print("📋 tips.csv 파일 정보:")
print(df_tips.info())

print(f"\n📊 상세 정보:")
print(f"행 수: {len(df_tips)}")
print(f"열 수: {len(df_tips.columns)}")
print(f"열 이름: {list(df_tips.columns)}")

# 3) 앞에서 3개 행만 출력
print(f"\n🔍 처음 3행:")
print(df_tips.head(3))

# 4) 요약 통계량
print(f"\n📈 요약 통계량:")
print(df_tips.describe())

# 문자열 포함 전체 요약
print(f"\n📊 전체 열 요약 (문자열 포함):")
print(df_tips.describe(include='all'))

# 5) 흡연자, 비흡연자 수 계산
print(f"\n🚭 흡연 여부별 고객 수:")
if 'smoker' in df_tips.columns:
    smoker_counts = df_tips['smoker'].value_counts()
    print(smoker_counts)
    print(f"비흡연자: {smoker_counts.get('No', 0)}명")
    print(f"흡연자: {smoker_counts.get('Yes', 0)}명")

# 6) 요일 유일한 값 출력
print(f"\n📅 요일 컬럼의 유일한 값들:")
day_columns = [col for col in df_tips.columns if 'day' in col.lower()]
if day_columns:
    day_col = day_columns[0]
    unique_days = df_tips[day_col].unique()
    print(f"{day_col} 열: {unique_days}")
    print("예상 결과: ['Sun' 'Sat' 'Thur' 'Fri']")
else:
    # 모든 열의 unique 값 확인
    print("모든 열의 고유값 확인:")
    for col in df_tips.columns:
        unique_count = df_tips[col].nunique()
        print(f"{col}: {unique_count}개 고유값")
        if df_tips[col].dtype == 'object' and unique_count <= 10:
            print(f"  → 값들: {list(df_tips[col].unique())}")
```

## 🎯 핵심 함수 요약

### 📊 데이터 탐색
```python
df.head(n)              # 처음 n행
df.tail(n)              # 마지막 n행
df.info()               # 데이터 타입, 결측치 정보
df.describe()           # 요약 통계량
df.shape                # (행수, 열수)
df.columns              # 열 이름들
df.dtypes               # 각 열의 데이터 타입
```

### 🔍 고유값 & 빈도
```python
df[col].unique()        # 고유값 배열
df[col].nunique()       # 고유값 개수  
df[col].value_counts()  # 값별 빈도수
```

### 🧹 결측치 처리
```python
df.isnull()             # 결측치 확인 (True/False)
df.isnull().sum()       # 각 열별 결측치 개수
df.dropna()             # 결측치 포함 행 삭제
df.dropna(subset=['col']) # 특정 열의 결측치만 체크
df.fillna(value)        # 결측치를 특정 값으로 채우기
```

### 🔄 데이터 변환
```python
pd.cut(data, bins, labels)     # 연속형 → 범주형 변환
df.pivot_table()               # 피벗 테이블 생성
df.groupby().agg()            # 그룹별 집계
df[col].str.strip()           # 문자열 양끝 공백 제거
```

## 🚀 실전 연습 과제

### 🎯 도전 과제 1: 타이타닉 심화 분석
```python
# 다음을 한 번에 분석해보세요
# 1) 나이대별, 성별, 등급별 생존율을 3차원으로 분석
# 2) 가장 생존율이 높은 그룹과 낮은 그룹 찾기
# 3) 승선료(Fare)가 생존에 미치는 영향 분석

def advanced_titanic_analysis(df):
    """타이타닉 데이터 고급 분석 함수"""
    # 여기에 코드를 작성해보세요!
    pass
```

### 🎯 도전 과제 2: 범용 CSV 분석기
```python
def analyze_csv(filename):
    """
    CSV 파일을 읽어서 기본 분석을 수행하는 함수
    - 파일 정보, 결측치, 요약통계, 상관관계 등을 한 번에 출력
    """
    # 여기에 코드를 작성해보세요!
    pass
```

## 🎉 마무리

이제 pandas의 핵심 기능들을 완전히 마스터했습니다! ✨

**습득한 스킬:**
- ✅ `cut()` 으로 데이터 구간화
- ✅ `pivot_table()` 로 다차원 분석  
- ✅ `dropna()`, `value_counts()`, `unique()` 등 기본 함수들
- ✅ `strip()` 으로 데이터 정제
- ✅ 결측치 처리와 데이터 품질 관리

**다음 단계**: 이 지식을 바탕으로 실제 프로젝트에 적용해보세요! 💪