# 18.03 matplotlib 시각화 복합 응용

## 1. 기본 설정 및 환경 구성

### 필수 라이브러리 및 초기 설정
```python
import numpy as np
import matplotlib.pyplot as plt
import pandas as pd

# 한글 폰트 설정 (필수)
plt.rc('font', family='Malgun Gothic')  # Windows: 맑은 고딕
# plt.rc('font', family='AppleGothic')   # macOS: 애플 고딕
plt.rcParams['axes.unicode_minus'] = False  # 마이너스 기호 깨짐 방지
```

### 주피터 노트북 환경
```python
%matplotlib inline  # 주피터 노트북에서 그래프 인라인 표시
```

## 2. 기본 그래프 그리기

### Line Chart (선 그래프)
```python
# 기본 선 그래프
x = ['서울', '인천', '수원']
y = [5, 3, 7]

plt.plot(x, y)
plt.show()

# 축 범위 설정
plt.xlim([-1, 3])
plt.ylim([0, 10])

# Y축 틱 설정
plt.yticks(list(range(0, 10, 3)))  # 0부터 10까지 3씩 증가
```

### 그래프 스타일링
```python
# SIN 곡선 예제
x = np.arange(10)
y = np.sin(x)

plt.plot(x, y, 'go--', linewidth=2, markersize=12)
# 'g': 초록색, 'o': 원형 마커, '--': 점선
# 스타일 옵션:
# - 색상: 'r'(빨강), 'b'(파랑), 'g'(초록), 'k'(검정)
# - 마커: 'o'(원), '+'(플러스), 's'(사각형)
# - 선 스타일: '-'(실선), '--'(점선), ':'(점선), '-.'(점대시선)
```

### 텍스트 라벨 추가
```python
# 데이터 포인트에 값 표시
data = np.arange(1, 11, 2)  # [1, 3, 5, 7, 9]
x = [0, 1, 2, 3, 4]

plt.plot(data)
for a, b in zip(x, data):
    plt.text(a, b, str(b))  # (x좌표, y좌표, 텍스트)
plt.show()
```

## 3. 복합 그래프 및 서브플롯

### 하나의 영역에 여러 그래프 (Hold)
```python
x = np.arange(0, 3 * np.pi, 0.1)
y_sin = np.sin(x)
y_cos = np.cos(x)

plt.figure(figsize=(10, 5))  # 그래프 크기 설정
plt.plot(x, y_sin, 'r', label='sin')
plt.plot(x, y_cos, 'b', label='cos')
plt.xlabel('x 축')
plt.ylabel('y 축')
plt.title('제목: sin & cos')
plt.legend()  # 범례 표시
plt.grid(True)  # 격자 표시
plt.show()
```

### 서브플롯 (Subplot)
```python
# 방법 1: matplotlib 스타일
plt.subplot(2, 1, 1)  # 2행 1열의 1번째
plt.plot(x, y_sin)
plt.title('사인')

plt.subplot(2, 1, 2)  # 2행 1열의 2번째
plt.plot(x, y_cos)
plt.title('코사인')
plt.show()

# 방법 2: 객체지향 스타일
fig, ax = plt.subplots(nrows=2, ncols=1)
ax[0].plot(x, np.sin(x))
ax[1].plot(x, np.cos(x))
plt.show()
```

## 4. 다양한 차트 유형

### 막대 그래프 (Bar Chart)
```python
data = [50, 80, 100, 70, 90]

# 세로 막대 그래프
plt.bar(range(len(data)), data)
plt.show()

# 가로 막대 그래프
plt.barh(range(len(data)), data)
plt.show()

# 오차 막대 포함
loss = np.random.rand(len(data))
plt.barh(range(len(data)), data, xerr=loss, alpha=0.7)
plt.show()
```

### 히스토그램
```python
# 연속형 데이터 분포 표현
fig = plt.figure()
ax1 = fig.add_subplot(1, 2, 1)
ax1.hist(np.random.randn(100), bins=10, color='blue', alpha=0.5)
plt.show()
```

### 원 그래프 (Pie Chart)
```python
plt.pie(data, 
        explode=[0, 0.1, 0, 0, 0],  # 조각 분리
        colors=['red', 'blue', 'yellow', 'purple'],
        autopct='%1.1f%%')  # 퍼센트 표시
plt.show()
```

### 박스 플롯 (Box Plot)
```python
# 4분위수 기반 데이터 분포 확인
plt.boxplot(data)
plt.show()
# 중앙값, 1사분위수, 3사분위수, 최솟값, 최댓값, 이상치 표시
```

### 산점도 및 버블 차트
```python
n = 30
np.random.seed(0)
x = np.random.rand(n)
y = np.random.rand(n)
colors = np.random.rand(n)
scale = np.pi * (15 * np.random.rand(n)) ** 2

plt.scatter(x, y, s=scale, c=colors, alpha=0.5)
# s: 크기, c: 색상, alpha: 투명도
plt.show()
```

## 5. 시계열 데이터 시각화

### Pandas와 연동한 시계열 그래프
```python
# 시계열 데이터 생성
fdata = pd.DataFrame(np.random.randn(1000, 4),
                     index=pd.date_range('1/1/2000', periods=1000),
                     columns=list('ABCD'))

# matplotlib 스타일
plt.plot(fdata.cumsum())
plt.show()

# pandas 내장 plot 메서드
fdata.plot()  # 기본 선 그래프
fdata.plot(kind='bar')  # 막대 그래프
fdata.plot(kind='box')  # 박스 플롯
plt.ylabel("time")
plt.xlabel("data")
plt.show()
```

## 6. 그래프 저장 및 이미지 처리

### 그래프 저장
```python
# 성적 데이터 예제
irum = ['a', 'b', 'c', 'd', 'e']
kor = [80, 50, 70, 70, 90]
eng = [60, 80, 70, 60, 90]

plt.plot(irum, kor, 'ro-', label='국어')
plt.plot(irum, eng, 'bo-', label='영어')
plt.ylim([0, 100])
plt.legend()
plt.grid(True)

fig = plt.gcf()  # 현재 figure 객체 가져오기
plt.show()
fig.savefig('result.png', dpi=300, bbox_inches='tight')  # 고해상도 저장
```

### 저장된 이미지 읽기
```python
from matplotlib.image import imread

img = imread('result.png')
plt.imshow(img)
plt.axis('off')  # 축 숨기기
plt.show()
```

## 7. 실무 적용 방안

### 데이터 분석 보고서
- **트렌드 분석**: 시계열 line chart로 매출, 사용자 증감 추이 표현
- **비교 분석**: 막대 그래프로 제품별, 지역별 성과 비교
- **분포 분석**: 히스토그램과 박스플롯으로 데이터 분포 특성 파악
- **상관관계**: 산점도로 변수 간 관계 시각화

### 프레젠테이션 및 대시보드
```python
# 전문적인 차트 스타일링
plt.style.use('seaborn-v0_8')  # 깔끔한 스타일
plt.figure(figsize=(12, 8))
plt.title('월별 매출 현황', fontsize=16, fontweight='bold')
plt.xlabel('월', fontsize=12)
plt.ylabel('매출 (백만원)', fontsize=12)
```

### 웹 애플리케이션 연동
- **Django/Flask**: 차트를 이미지로 저장 후 웹페이지에 삽입
- **Streamlit**: 실시간 인터랙티브 대시보드 구축
- **Jupyter Dashboard**: 분석 결과를 대시보드 형태로 공유

### 동적 vs 정적 시각화의 선택
```python
# 정적 이미지 저장 (PNG)
fig = plt.gcf()  # Get Current Figure
plt.show()
fig.savefig('result.png', dpi=300, bbox_inches='tight')

# 장점: 빠른 로딩, 안정적, 웹에서 바로 표시
# 용도: 보고서, 프레젠테이션, 정적 웹페이지
```

**📊 Chart.js와의 비교**
- **Matplotlib → PNG**: 정적, 빠름, 서버에서 생성
- **Chart.js**: 동적, 인터랙티브, 브라우저에서 실시간 렌더링
- **선택 기준**: 인터랙션 필요성과 성능 요구사항

## 8. 관련 라이브러리 및 발전 방향

### matplotlib 한계점과 강의에서 언급된 대안

#### matplotlib 특징
- **장점**: 안정적, 세밀한 제어 가능, 다양한 차트 지원
- **단점**: 기본 스타일이 다소 투박, 통계 차트 구현의 복잡성

#### Seaborn - matplotlib의 확장
```python
import seaborn as sns
# matplotlib 기반으로 더 아름다운 기본 스타일 제공
# 복잡한 통계 차트를 간단한 코드로 구현
# R 수준의 시각화 기능 구현
```

**강의에서 강조한 점**: "Seaborn이 matplotlib의 기능을 보강하기 위해 나왔다"

#### 웹 시각화 라이브러리들

**Chart.js (JavaScript)**
```javascript
// 웹 브라우저에서 동적 차트 생성
// Django, Flask와 연동하여 동적 웹 차트 구현
// 사용자 상호작용 (줌, 필터, 호버) 지원
```

**Toast UI Chart**
- 모던한 웹 차트 라이브러리
- 게시판, 에디터 등과 함께 사용
- 깔끔한 UI/UX 제공

### 실무에서의 라이브러리 선택 전략

#### 상황별 최적 선택
```python
# 데이터 탐색 및 분석 단계
matplotlib + seaborn  # 빠른 프로토타이핑

# 정적 보고서 생성
matplotlib → PNG/PDF  # 안정적, 고품질

# 웹 애플리케이션 
Chart.js + JSON 데이터  # 동적 인터랙션

# 대시보드
Plotly + Dash  # 인터랙티브 대시보드
```

#### 무료 도구의 활용
**강의에서 언급**: "Chart.js, Toast UI 등은 모두 무료다. 라이브러리가 있으면 최대한 활용하는 것이 중요하다."

## 8. 관련 라이브러리 및 발전 방향

### matplotlib 한계점
- 기본 스타일이 다소 투박함
- 복잡한 통계 차트 구현의 어려움
- 인터랙티브 기능 제한적

### 대안 및 확장 라이브러리

#### Seaborn
```python
import seaborn as sns
# matplotlib 기반, 통계 시각화에 특화
# 더 아름다운 기본 스타일
# 복잡한 통계 차트 간단 구현
```

#### Plotly
```python
import plotly.express as px
# 인터랙티브 차트 (줌, 필터, 호버)
# 웹 브라우저에서 바로 동작
# 3D 시각화 지원
```

#### Chart.js (웹 환경)
- JavaScript 기반 차트 라이브러리
- Django/Flask와 연동하여 동적 웹 차트 구현
- 반응형 디자인 지원

#### 기타 특화 라이브러리
- **Altair**: 문법 기반 시각화 (Grammar of Graphics)
- **Bokeh**: 대용량 데이터 웹 시각화
- **Pygal**: SVG 기반 차트 (벡터 그래픽)

### UI/UX 라이브러리 연동
- **Toast UI Chart**: 모던한 웹 차트
- **D3.js**: 커스텀 시각화의 최고봉
- **Apache ECharts**: 대용량 데이터 시각화

## 14. 강의에서 강조한 핵심 실무 인사이트

### 🎯 중요한 실무 관점들

#### 데이터 분석에서 시각화의 역할
```python
# "박스플롯은 데이터 분석하는 사람들에게 정말 중요하다"
# - 4분위수 기반으로 데이터 분포 한눈에 파악
# - 아웃라이어(이상치) 쉽게 발견
# - 대량의 데이터도 요약적으로 표현 가능

plt.boxplot(data)  # 이것만으로도 데이터의 전체적 특성 파악!
```

#### 산점도의 미래 중요성
```python
# "산점도는 앞으로 엄청 많이 만날 것"
# - 상관분석에서 핵심
# - 회귀분석에서 관계 시각화
# - 머신러닝에서 데이터 분포 확인

plt.scatter(x, y)  # 데이터 사이언스의 필수 도구
```

#### 차트별 데이터 적용 한계
```python
# "막대그래프, 파이차트는 소량 데이터만 가능"
# "1000명 학생 데이터를 파이차트로? 불가능!"

if len(data) > 20:
    # 대량 데이터는 히스토그램, 박스플롯 사용
    plt.hist(data, bins=30)
else:
    # 소량 데이터만 막대/파이 차트
    plt.bar(range(len(data)), data)
```

### 🚀 발전 경로 및 학습 방향

#### 학습 순서
1. **matplotlib 기초**: 모든 시각화의 기반
2. **Seaborn**: 통계 시각화의 고급화
3. **웹 연동**: Chart.js, 동적 시각화
4. **전문 영역**: 도메인별 특화 라이브러리

#### 실무 적용 단계
```python
# 1단계: 데이터 탐색 (matplotlib + seaborn)
# 2단계: 분석 결과 정리 (matplotlib → 보고서)
# 3단계: 웹 서비스 (Chart.js + JSON)
# 4단계: 대시보드 (Plotly, Bokeh)
```

### ⚡ 마지막 핵심 메시지

#### 강의에서의 철학
- **"라이브러리가 있으면 최대한 활용하라"**
- **"데이터를 보고 적절한 차트를 판단할 줄 알아야 한다"**  
- **"시행착오를 거쳐야 실력이 늘어난다"**

#### 실무에서의 현실
```python
# matplotlib은 "고전적"이지만 여전히 기초
# pandas와의 완벽한 연동으로 실무 필수
# DataFrame → plot() 메서드로 간편 시각화도 가능

df.plot()  # pandas 내장 시각화
df.plot(kind='bar')  # 막대그래프
df.plot(kind='box')  # 박스플롯
```

## 15. 다음 단계: Seaborn으로의 발전

### matplotlib → Seaborn 진화
```python
# matplotlib의 한계
plt.figure(figsize=(10, 6))
plt.bar(categories, values)
plt.title('기본적인 막대그래프')
plt.show()

# Seaborn의 우아함 (다음 강의에서!)
import seaborn as sns
sns.barplot(x=categories, y=values)  # 더 아름다운 기본 스타일
```

**강의 마무리**: "다음에는 Seaborn으로 그럴 듯한 데이터를 가지고 연습해보자"

## 9. 고급 차트 및 데이터 분석

### 히스토그램 (연속형 데이터 분포)
```python
# 객체지향 스타일 히스토그램
fig = plt.figure()
ax1 = fig.add_subplot(1, 2, 1)  # 1행 2열의 첫 번째
ax1.hist(np.random.randn(100), bins=10, color='blue', alpha=0.5)
ax1.set_title('정규분포 히스토그램')

# bins 설정으로 구간 조절
plt.hist(data, bins=5, alpha=0.7)  # 5개 구간으로 설정
plt.show()
```

### 박스 플롯 (Box Plot) - 데이터 분석의 핵심!
```python
# 4분위수 기반 데이터 분포 확인
plt.boxplot(data)
plt.show()

# 박스 플롯 해석
# - 상자 중앙선: 중앙값 (median)
# - 상자 아래: 1사분위수 (25% 지점)
# - 상자 위: 3사분위수 (75% 지점)  
# - 수염 아래: 최솟값
# - 수염 위: 최댓값
# - 동그라미: 이상치(outlier)
```

### 버블 차트 (데이터 크기 시각화)
```python
n = 30
np.random.seed(0)  # 결과 재현을 위한 시드 고정
x = np.random.rand(n)
y = np.random.rand(n)
colors = np.random.rand(n)
scale = np.pi * (15 * np.random.rand(n)) ** 2  # 버블 크기

plt.scatter(x, y, s=scale, c=colors, alpha=0.5)
plt.show()
# s: 크기, c: 색상, alpha: 투명도
```

### 파이 차트 고급 옵션
```python
data = [50, 80, 100, 70, 90]
plt.pie(data, 
        explode=[0, 0.1, 0, 0, 0],  # 두 번째 조각 분리
        colors=['red', 'blue', 'yellow', 'purple', 'green'],
        autopct='%1.1f%%')  # 퍼센트 표시
plt.show()

# explode: 조각 분리 정도 (0은 붙어있음, 0.1은 약간 분리)
```

## 10. 범례와 그리드 고급 설정

### 범례 위치 제어
```python
# 성적 데이터 예제
names = ['a', 'b', 'c', 'd', 'e']
korean = [80, 50, 70, 70, 90]
english = [60, 80, 70, 60, 90]

plt.plot(names, korean, 'ro-', label='국어')
plt.plot(names, english, 'bo-', label='영어')
plt.ylim([0, 100])

# 범례 위치 설정 (1,2,3,4 시계 반대방향)
plt.legend(loc=1)  # 1: 우상단, 2: 좌상단, 3: 좌하단, 4: 우하단
# plt.legend(loc='best')  # 자동으로 최적 위치 선택

# 그리드 표시
plt.grid(True)
plt.show()
```

## 11. 객체지향 vs Matplotlib 스타일

### 두 가지 Figure 생성 방법

#### 방법 1: Matplotlib 스타일 인터페이스
```python
plt.figure()
plt.subplot(2, 1, 1)  # row, column, panel number
plt.plot(x, np.sin(x))
plt.subplot(2, 1, 2)
plt.plot(x, np.cos(x))
plt.show()
```

#### 방법 2: 객체지향 인터페이스
```python
fig, ax = plt.subplots(nrows=2, ncols=1)
ax[0].plot(x, np.sin(x))
ax[1].plot(x, np.cos(x))
plt.show()

# 또는 명시적으로
fig = plt.figure()
ax1 = fig.add_subplot(1, 2, 1)  # 1행 2열의 1번째
ax2 = fig.add_subplot(1, 2, 2)  # 1행 2열의 2번째
```

## 12. 오차막대와 통계 시각화
```python
# 가로막대 그래프 + 오차막대
data = [50, 80, 100, 70, 90]
errors = np.random.rand(len(data))  # 랜덤 오차값

plt.barh(range(len(data)), data, xerr=errors, alpha=0.7)
plt.show()

# xerr: 가로 오차막대, yerr: 세로 오차막대
# alpha: 투명도 (0: 투명, 1: 불투명)
```

## 13. 실무 팁 및 베스트 프랙티스

### 차트 선택 가이드
- **시간 변화**: Line Chart
- **카테고리 비교**: Bar Chart  
- **비율 표현**: Pie Chart (소량 데이터만)
- **분포 확인**: Histogram, Box Plot ⭐ (매우 중요!)
- **관계 분석**: Scatter Plot (상관분석, 회귀분석에서 많이 사용)
- **대용량 데이터**: Heat Map

### 데이터 양에 따른 차트 선택
```python
# 소량 데이터 (5-10개): 막대그래프, 파이차트
# 중량 데이터 (100-1000개): 히스토그램, 박스플롯
# 대량 데이터 (1000개+): 산점도, 히트맵

# 막대그래프와 파이차트는 다량 데이터 표현에 한계
if len(data) > 50:
    plt.hist(data, bins=20)  # 히스토그램 사용
else:
    plt.bar(range(len(data)), data)  # 막대그래프 사용
```

### 성능 최적화
```python
# 대용량 데이터 처리 시
plt.ioff()  # 인터랙티브 모드 끄기
# ... 차트 그리기 ...
plt.savefig('chart.png')
plt.close()  # 메모리 해제
```

### 색상 및 접근성
```python
# 색맹 친화적 색상 팔레트
colors = ['#1f77b4', '#ff7f0e', '#2ca02c', '#d62728']
# 또는 colorbrewer 팔레트 사용
```

이렇게 matplotlib을 활용하여 다양한 시각화를 구현할 수 있으며, 실무에서는 목적에 맞는 차트 유형을 선택하고 적절한 라이브러리와 조합하여 사용하는 것이 중요합니다.