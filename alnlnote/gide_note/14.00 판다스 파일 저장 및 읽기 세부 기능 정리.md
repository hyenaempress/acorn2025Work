# 14. íŒë‹¤ìŠ¤ íŒŒì¼ ì €ì¥ ë° ì½ê¸° ì„¸ë¶€ ê¸°ëŠ¥ ì •ë¦¬

## ğŸ“‹ ê°œìš”

íŒë‹¤ìŠ¤(Pandas)ëŠ” ë‹¤ì–‘í•œ íŒŒì¼ í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ì½ê³  ì €ì¥í•  ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ I/O ê¸°ëŠ¥ì„ ì œê³µí•©ë‹ˆë‹¤. ì´ ê°€ì´ë“œëŠ” ì‹¤ë¬´ì—ì„œ ìì£¼ ì‚¬ìš©ë˜ëŠ” íŒŒì¼ ì…ì¶œë ¥ ê¸°ëŠ¥ë“¤ì„ ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬í•˜ê³ , ì‹¤ì œ ì½”ë“œ ì˜ˆì œì™€ í•¨ê»˜ ì„¤ëª…í•©ë‹ˆë‹¤.

## ğŸ”§ ì£¼ìš” íŒŒì¼ í˜•ì‹ ì§€ì›

| í˜•ì‹ | ì½ê¸° í•¨ìˆ˜ | ì €ì¥ ë©”ì„œë“œ | íŠ¹ì§• |
|------|----------|-------------|------|
| CSV | `pd.read_csv()` | `df.to_csv()` | ë²”ìš©ì , ê²½ëŸ‰ |
| Excel | `pd.read_excel()` | `df.to_excel()` | ë‹¤ì¤‘ ì‹œíŠ¸ ì§€ì› |
| JSON | `pd.read_json()` | `df.to_json()` | ì›¹ API í˜¸í™˜ |
| HTML | `pd.read_html()` | `df.to_html()` | ì›¹ ìŠ¤í¬ë˜í•‘ |
| í…ìŠ¤íŠ¸ | `pd.read_table()` | - | êµ¬ë¶„ì ì§€ì • |
| FWF | `pd.read_fwf()` | - | ê³ ì • í­ íŒŒì¼ |

---

## ğŸ“‚ CSV íŒŒì¼ ì²˜ë¦¬

### ê¸°ë³¸ CSV ì½ê¸° ë° ì €ì¥

```python
import pandas as pd
import numpy as np

# ê¸°ë³¸ CSV íŒŒì¼ ì½ê¸°
df = pd.read_csv('data.csv')
print(df.head())

# êµ¬ë¶„ì ì§€ì •í•˜ì—¬ ì½ê¸°
df = pd.read_csv('data.csv', sep=',')  # ê¸°ë³¸ê°’
df = pd.read_csv('data.txt', sep='\s+')  # ê³µë°±ìœ¼ë¡œ êµ¬ë¶„

# ê¸°ë³¸ CSV ì €ì¥
df.to_csv('output.csv', index=False)  # ì¸ë±ìŠ¤ ì œì™¸í•˜ê³  ì €ì¥
```

### ê³ ê¸‰ CSV ì˜µì…˜

```python
# í—¤ë” ì²˜ë¦¬
df = pd.read_csv('data.csv', header=None)  # ì²« ì¤„ì„ í—¤ë”ë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
df = pd.read_csv('data.csv', names=['A', 'B', 'C'])  # ì‚¬ìš©ì ì •ì˜ ì»¬ëŸ¼ëª…

# íŠ¹ì • í–‰ ê±´ë„ˆë›°ê¸°
df = pd.read_csv('data.csv', skiprows=1)  # ì²« ë²ˆì§¸ í–‰ ê±´ë„ˆë›°ê¸°
df = pd.read_csv('data.csv', skiprows=[0, 2])  # 0ë²ˆì§¸, 2ë²ˆì§¸ í–‰ ê±´ë„ˆë›°ê¸°

# ì¸ì½”ë”© ì²˜ë¦¬
df = pd.read_csv('korean_data.csv', encoding='utf-8-sig')  # í•œê¸€ íŒŒì¼
df = pd.read_csv('data.csv', encoding='cp949')  # ìœˆë„ìš° í•œê¸€

# ê²°ì¸¡ê°’ ì²˜ë¦¬
df = pd.read_csv('data.csv', na_values=['N/A', 'NULL', '-'])

# ë°ì´í„° íƒ€ì… ì§€ì •
dtype_dict = {'id': str, 'score': int}
df = pd.read_csv('data.csv', dtype=dtype_dict)
```

### ì •ê·œí‘œí˜„ì‹ì„ ì´ìš©í•œ êµ¬ë¶„ì ì²˜ë¦¬

```python
# ê³µë°±ìœ¼ë¡œ êµ¬ë¶„ëœ íŒŒì¼ ì½ê¸° (ì •ê·œí‘œí˜„ì‹ ì‚¬ìš©)
df = pd.read_table('data.txt', sep=r'\s+')

# ì—¬ëŸ¬ ì¢…ë¥˜ì˜ êµ¬ë¶„ì ì²˜ë¦¬
df = pd.read_csv('data.csv', sep=r'[,;|\t]', engine='python')
```

**ğŸ’¡ ì •ê·œí‘œí˜„ì‹ íŒ¨í„´**
- `\s+`: í•˜ë‚˜ ì´ìƒì˜ ê³µë°± ë¬¸ì
- `[,;|\t]`: ì‰¼í‘œ, ì„¸ë¯¸ì½œë¡ , íŒŒì´í”„, íƒ­ ì¤‘ í•˜ë‚˜
- ë³µì¡í•œ íŒ¨í„´ ì²˜ë¦¬ ì‹œ `engine='python'` í•„ìš”

### ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ (ì²­í¬ ë‹¨ìœ„)

```python
# ì²­í¬ ë‹¨ìœ„ë¡œ íŒŒì¼ ì½ê¸°
chunk_size = 10000
chunks = []

for chunk in pd.read_csv('big_data.csv', chunksize=chunk_size):
    # ê° ì²­í¬ì— ëŒ€í•œ ì²˜ë¦¬
    processed_chunk = chunk[chunk['score'] > 80]
    chunks.append(processed_chunk)

# ëª¨ë“  ì²­í¬ ê²°í•©
result = pd.concat(chunks, ignore_index=True)
```

---

## ğŸ“Š Excel íŒŒì¼ ì²˜ë¦¬

### ê¸°ë³¸ Excel ì½ê¸° ë° ì €ì¥

```python
# Excel íŒŒì¼ ì½ê¸°
df = pd.read_excel('data.xlsx')  # ì²« ë²ˆì§¸ ì‹œíŠ¸
df = pd.read_excel('data.xlsx', sheet_name='Sheet1')  # íŠ¹ì • ì‹œíŠ¸

# Excel íŒŒì¼ ì €ì¥
df.to_excel('output.xlsx', index=False)
```

### ë‹¤ì¤‘ ì‹œíŠ¸ ì²˜ë¦¬

```python
# ì—¬ëŸ¬ ì‹œíŠ¸ ë™ì‹œ ì½ê¸°
excel_dict = pd.read_excel('data.xlsx', sheet_name=None)  # ëª¨ë“  ì‹œíŠ¸
print(excel_dict.keys())  # ì‹œíŠ¸ ì´ë¦„ë“¤

# íŠ¹ì • ì‹œíŠ¸ë“¤ë§Œ ì½ê¸°
sheets_dict = pd.read_excel('data.xlsx', sheet_name=['Sheet1', 'Sheet2'])

# ì—¬ëŸ¬ ì‹œíŠ¸ë¡œ ì €ì¥
with pd.ExcelWriter('multi_sheet.xlsx') as writer:
    df1.to_excel(writer, sheet_name='ë°ì´í„°1', index=False)
    df2.to_excel(writer, sheet_name='ë°ì´í„°2', index=False)
```

### Excel ê³ ê¸‰ ì˜µì…˜

```python
# íŠ¹ì • ë²”ìœ„ ì½ê¸°
df = pd.read_excel('data.xlsx', 
                  usecols='A:C',  # Aë¶€í„° Cì—´ë§Œ
                  nrows=100)      # 100í–‰ë§Œ

# í—¤ë” í–‰ ì§€ì •
df = pd.read_excel('data.xlsx', header=[0, 1])  # ë‹¤ì¤‘ í—¤ë”
```

---

## ğŸŒ JSON íŒŒì¼ ì²˜ë¦¬

### JSON ê¸°ë³¸ ì²˜ë¦¬

```python
# JSON íŒŒì¼ë¡œ ì €ì¥
df.to_json('data.json')
df.to_json('data.json', orient='records')  # ë ˆì½”ë“œ í˜•íƒœ
df.to_json('data.json', orient='index')    # ì¸ë±ìŠ¤ ê¸°ë°˜

# JSON íŒŒì¼ ì½ê¸°
df = pd.read_json('data.json')
```

### JSON í˜•íƒœë³„ ì €ì¥ ë°©ì‹

```python
# ìƒ˜í”Œ ë°ì´í„°
data = {'name': ['Alice', 'Bob'], 'age': [25, 30]}
df = pd.DataFrame(data)

# 1. ê¸°ë³¸ í˜•íƒœ (ì»¬ëŸ¼ ê¸°ë°˜)
df.to_json('basic.json')  
# {"name":{"0":"Alice","1":"Bob"},"age":{"0":25,"1":30}}

# 2. ë ˆì½”ë“œ í˜•íƒœ (ì›¹ APIì— ì í•©)
df.to_json('records.json', orient='records')
# [{"name":"Alice","age":25},{"name":"Bob","age":30}]

# 3. ê°’ë§Œ ì €ì¥
df.to_json('values.json', orient='values')
# [["Alice",25],["Bob",30]]
```

---

## ğŸŒ HTML í…Œì´ë¸” ì²˜ë¦¬

### HTML í…Œì´ë¸” ì½ê¸° ë° ì €ì¥

```python
# ì›¹í˜ì´ì§€ì—ì„œ í…Œì´ë¸” ì½ê¸°
tables = pd.read_html('https://example.com/table')
df = tables[0]  # ì²« ë²ˆì§¸ í…Œì´ë¸”

# HTML íŒŒì¼ë¡œ ì €ì¥
df.to_html('table.html', index=False)

# ìŠ¤íƒ€ì¼ë§ì„ í¬í•¨í•œ HTML ì €ì¥
df.to_html('styled_table.html', 
          index=False,
          table_id='data-table',
          classes='table table-striped')
```

---

## ğŸ”§ ê³ ê¸‰ íŒŒì¼ ì²˜ë¦¬ ê¸°ë²•

### 1. ì¸ì½”ë”© ë¬¸ì œ í•´ê²°

```python
# í•œê¸€ íŒŒì¼ ì²˜ë¦¬ ì‹œ ê¶Œì¥ ì„¤ì •
encodings_to_try = ['utf-8', 'utf-8-sig', 'cp949', 'euc-kr']

def read_csv_safe(filepath):
    for encoding in encodings_to_try:
        try:
            df = pd.read_csv(filepath, encoding=encoding)
            print(f"ì„±ê³µ: {encoding}")
            return df
        except UnicodeDecodeError:
            print(f"ì‹¤íŒ¨: {encoding}")
            continue
    return None
```

### 2. íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸

```python
import os

def safe_read_csv(filepath):
    if os.path.exists(filepath):
        return pd.read_csv(filepath)
    else:
        print(f"íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: {filepath}")
        return None

# ì‚¬ìš© ì˜ˆì‹œ
df = safe_read_csv('data.csv')
if df is not None:
    print(df.head())
```

### 3. ë©”ëª¨ë¦¬ ìµœì í™” ë°ì´í„° íƒ€ì…

```python
# ë©”ëª¨ë¦¬ íš¨ìœ¨ì ì¸ ë°ì´í„° íƒ€ì… ì§€ì •
efficient_dtypes = {
    'id': 'int32',      # int64 â†’ int32
    'category': 'category',  # object â†’ category
    'score': 'float32'  # float64 â†’ float32
}

df = pd.read_csv('data.csv', dtype=efficient_dtypes)
print(f"ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: {df.memory_usage(deep=True).sum()} bytes")
```

### 4. ë°°ì¹˜ íŒŒì¼ ì²˜ë¦¬

```python
import glob

# ì—¬ëŸ¬ CSV íŒŒì¼ì„ í•˜ë‚˜ë¡œ í•©ì¹˜ê¸°
csv_files = glob.glob("data_*.csv")
dataframes = []

for file in csv_files:
    df_temp = pd.read_csv(file)
    df_temp['source_file'] = file  # ì¶œì²˜ íŒŒì¼ëª… ì¶”ê°€
    dataframes.append(df_temp)

# ëª¨ë“  íŒŒì¼ ê²°í•©
combined_df = pd.concat(dataframes, ignore_index=True)
combined_df.to_csv('combined_data.csv', index=False)
```

---

## ğŸ¯ ì„±ëŠ¥ ë¹„êµ ë° ì„ íƒ ê°€ì´ë“œ

### íŒŒì¼ í˜•ì‹ë³„ ì„±ëŠ¥ íŠ¹ì„±

| í˜•ì‹ | ì½ê¸° ì†ë„ | íŒŒì¼ í¬ê¸° | í˜¸í™˜ì„± | ì‚¬ìš© ì‚¬ë¡€ |
|------|-----------|-----------|--------|-----------|
| CSV | ë¹ ë¦„ | ë³´í†µ | ë†’ìŒ | ë²”ìš© ë°ì´í„° êµí™˜ |
| Excel | ë³´í†µ | í¼ | ë³´í†µ | ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì„œ |
| JSON | ë³´í†µ | í¼ | ë†’ìŒ | ì›¹ API, ì„¤ì • íŒŒì¼ |
| Parquet | ë§¤ìš° ë¹ ë¦„ | ì‘ìŒ | ë‚®ìŒ | ë¹…ë°ì´í„° ë¶„ì„ |

### ìƒí™©ë³„ ê¶Œì¥ í˜•ì‹

```python
# ìƒí™©ë³„ ê¶Œì¥ íŒŒì¼ í˜•ì‹

# 1. ë²”ìš© ë°ì´í„° êµí™˜ â†’ CSV
df.to_csv('data.csv', index=False)

# 2. ë¹„ì¦ˆë‹ˆìŠ¤ ë³´ê³ ì„œ â†’ Excel
df.to_excel('report.xlsx', index=False)

# 3. ì›¹ API ë°ì´í„° â†’ JSON
df.to_json('api_data.json', orient='records')

# 4. ëŒ€ìš©ëŸ‰ ë¶„ì„ ë°ì´í„° â†’ Parquet (ë³„ë„ ë¼ì´ë¸ŒëŸ¬ë¦¬ í•„ìš”)
# df.to_parquet('big_data.parquet')

# 5. ì›¹ í‘œì‹œìš© â†’ HTML
df.to_html('table.html', index=False, table_id='data-table')
```

---

## ğŸš¨ ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œì™€ í•´ê²°ì±…

### 1. ì¸ì½”ë”© ë¬¸ì œ
```python
# ë¬¸ì œ: UnicodeDecodeError
# í•´ê²°: ì ì ˆí•œ ì¸ì½”ë”© ì§€ì •
df = pd.read_csv('korean_data.csv', encoding='cp949')
```

### 2. êµ¬ë¶„ì ë¬¸ì œ
```python
# ë¬¸ì œ: ë°ì´í„°ê°€ ì œëŒ€ë¡œ ë¶„ë¦¬ë˜ì§€ ì•ŠìŒ
# í•´ê²°: ì •í™•í•œ êµ¬ë¶„ì ì§€ì •
df = pd.read_csv('data.txt', sep='\t')  # íƒ­ êµ¬ë¶„
df = pd.read_csv('data.txt', sep=r'\s+')  # ê³µë°± êµ¬ë¶„
```

### 3. ë©”ëª¨ë¦¬ ë¶€ì¡±
```python
# ë¬¸ì œ: ëŒ€ìš©ëŸ‰ íŒŒì¼ ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ ë¶€ì¡±
# í•´ê²°: ì²­í¬ ë‹¨ìœ„ ì²˜ë¦¬
for chunk in pd.read_csv('big_file.csv', chunksize=10000):
    process_chunk(chunk)
```

---

## ğŸ“‹ ì¢…í•© ì‹¤ìŠµ ì˜ˆì œ

```python
def comprehensive_file_io_example():
    """
    íŒë‹¤ìŠ¤ íŒŒì¼ ì…ì¶œë ¥ ì¢…í•© ì˜ˆì œ
    """
    
    # 1. ë°ì´í„° ìƒì„±
    print("1. ìƒ˜í”Œ ë°ì´í„° ìƒì„±")
    data = {
        'product_id': range(1, 101),
        'product_name': [f'Product_{i}' for i in range(1, 101)],
        'price': np.random.randint(1000, 100000, 100),
        'category': np.random.choice(['A', 'B', 'C'], 100),
        'stock': np.random.randint(0, 50, 100)
    }
    df = pd.DataFrame(data)
    print(f"ë°ì´í„° í˜•íƒœ: {df.shape}")
    
    # 2. ë‹¤ì–‘í•œ í˜•ì‹ìœ¼ë¡œ ì €ì¥
    print("\n2. ë‹¤ì–‘í•œ í˜•ì‹ìœ¼ë¡œ ì €ì¥")
    
    # CSV ì €ì¥
    df.to_csv('products.csv', index=False, encoding='utf-8-sig')
    print("âœ“ CSV íŒŒì¼ ì €ì¥ ì™„ë£Œ")
    
    # Excel ì €ì¥ (ë‹¤ì¤‘ ì‹œíŠ¸)
    with pd.ExcelWriter('products.xlsx') as writer:
        df.to_excel(writer, sheet_name='ì „ì²´ë°ì´í„°', index=False)
        df[df['category'] == 'A'].to_excel(writer, sheet_name='ì¹´í…Œê³ ë¦¬A', index=False)
        df[df['category'] == 'B'].to_excel(writer, sheet_name='ì¹´í…Œê³ ë¦¬B', index=False)
    print("âœ“ Excel íŒŒì¼ ì €ì¥ ì™„ë£Œ")
    
    # JSON ì €ì¥
    df.to_json('products.json', orient='records', indent=2)
    print("âœ“ JSON íŒŒì¼ ì €ì¥ ì™„ë£Œ")
    
    # 3. íŒŒì¼ ì½ê¸° ë° ê²€ì¦
    print("\n3. íŒŒì¼ ì½ê¸° ë° ê²€ì¦")
    
    # CSV ì½ê¸°
    df_csv = pd.read_csv('products.csv', encoding='utf-8-sig')
    print(f"CSVì—ì„œ ì½ì€ ë°ì´í„°: {df_csv.shape}")
    
    # Excel ì½ê¸°
    df_excel = pd.read_excel('products.xlsx', sheet_name='ì „ì²´ë°ì´í„°')
    print(f"Excelì—ì„œ ì½ì€ ë°ì´í„°: {df_excel.shape}")
    
    # JSON ì½ê¸°
    df_json = pd.read_json('products.json')
    print(f"JSONì—ì„œ ì½ì€ ë°ì´í„°: {df_json.shape}")
    
    # 4. ë°ì´í„° ì¼ì¹˜ì„± ê²€ì¦
    print(f"\n4. ë°ì´í„° ì¼ì¹˜ì„± ê²€ì¦")
    print(f"ì›ë³¸ê³¼ CSV ë™ì¼: {df.equals(df_csv)}")
    print(f"ì›ë³¸ê³¼ Excel ë™ì¼: {df.equals(df_excel)}")
    print(f"ì›ë³¸ê³¼ JSON ë™ì¼: {df.equals(df_json.sort_values('product_id').reset_index(drop=True))}")

# ì‹¤í–‰
comprehensive_file_io_example()
```

---

## ğŸ¯ í•µì‹¬ ìš”ì•½

### ë°˜ë“œì‹œ ê¸°ì–µí•  í¬ì¸íŠ¸

1. **íŒŒì¼ í˜•ì‹ë³„ íŠ¹ì§• ì´í•´**
   - CSV: ë²”ìš©ì„±, ê°€ë²¼ì›€, ë¹ ë¥¸ ì²˜ë¦¬
   - Excel: ë¹„ì¦ˆë‹ˆìŠ¤ ì¹œí™”ì , ë‹¤ì¤‘ ì‹œíŠ¸, ì„œì‹ ì§€ì›
   - JSON: ì›¹ ì¹œí™”ì , êµ¬ì¡°ì  ë°ì´í„°, API í˜¸í™˜

2. **ì¸ì½”ë”© ì²˜ë¦¬**
   - í•œê¸€ íŒŒì¼: `encoding='utf-8-sig'` ë˜ëŠ” `encoding='cp949'`
   - ì›¹ ë°ì´í„°: `encoding='utf-8'`
   - ìë™ ê°ì§€: ì—¬ëŸ¬ ì¸ì½”ë”© ì‹œë„

3. **ì„±ëŠ¥ ìµœì í™”**
   - ëŒ€ìš©ëŸ‰ íŒŒì¼: ì²­í¬ ì²˜ë¦¬ í™œìš©
   - ë°ì´í„° íƒ€ì… ìµœì í™”ë¡œ ë©”ëª¨ë¦¬ ì ˆì•½
   - í•„ìš”í•œ ì»¬ëŸ¼ë§Œ ì½ê¸° (`usecols` í™œìš©)

4. **ì‹¤ë¬´ í™œìš© íŒ¨í„´**
   - íŒŒì¼ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
   - ì˜ˆì™¸ ì²˜ë¦¬ êµ¬í˜„
   - ë°°ì¹˜ ì²˜ë¦¬ ìë™í™”
   - ë°ì´í„° ê²€ì¦ í”„ë¡œì„¸ìŠ¤

íŒë‹¤ìŠ¤ì˜ íŒŒì¼ I/O ê¸°ëŠ¥ì„ ë§ˆìŠ¤í„°í•˜ë©´ ë‹¤ì–‘í•œ ë°ì´í„° ì†ŒìŠ¤ì™€ì˜ ì—°ë™ì´ ê°€ëŠ¥í•´ì§€ë©°, ì‹¤ë¬´ì—ì„œì˜ ë°ì´í„° ì²˜ë¦¬ íš¨ìœ¨ì„±ì´ í¬ê²Œ í–¥ìƒë©ë‹ˆë‹¤! ğŸ’ª
