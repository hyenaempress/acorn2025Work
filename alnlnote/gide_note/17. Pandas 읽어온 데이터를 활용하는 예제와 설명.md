# 17. ì½ì–´ì˜¨ ë°ì´í„°ë¥¼ í™œìš©í•˜ëŠ” ì˜ˆì œì™€ ì„¤ëª…

## ğŸ“‹ ê°œìš”

ì›¹ì—ì„œ ìˆ˜ì§‘í•œ ë°ì´í„° (ì˜ˆ: ë„¤ì´ë²„ ì½”ìŠ¤í”¼ ë°ì´í„°)ë¥¼ íŒë‹¤ìŠ¤ë¡œ ì½ì–´ì˜¨ í›„, ì‹¤ë¬´ì—ì„œ í™œìš©í•  ìˆ˜ ìˆëŠ” ë‹¤ì–‘í•œ ë°ì´í„° ë¶„ì„ ë° ì²˜ë¦¬ ë°©ë²•ì„ ë‹¨ê³„ë³„ë¡œ ì„¤ëª…í•©ë‹ˆë‹¤.

---

## ğŸ”§ ê¸°ë³¸ ë°ì´í„° ì½ê¸° ë° ì ê²€

### 1. ìˆ˜ì§‘ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°

```python
import pandas as pd
import numpy as np
import re

# í¬ë¡¤ë§ìœ¼ë¡œ ì €ì¥ëœ CSV íŒŒì¼ ì½ê¸°
df = pd.read_csv('ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv', dtype=str, index_col=False)
print("=== ì›ë³¸ ë°ì´í„° í™•ì¸ ===")
print(f"ë°ì´í„° í˜•íƒœ: {df.shape}")
print(df.head(3))
```

### 2. ë°ì´í„° êµ¬ì¡° íŒŒì•…

```python
# ë°ì´í„° ì •ë³´ í™•ì¸
print("\n=== ë°ì´í„° ì •ë³´ ===")
print(df.info())
print("\n=== ì»¬ëŸ¼ë³„ ê²°ì¸¡ê°’ ===")
print(df.isnull().sum())
print("\n=== ê° ì»¬ëŸ¼ì˜ ìƒ˜í”Œ ê°’ ===")
for col in df.columns:
    print(f"{col}: {df[col].dropna().head(3).tolist()}")
```

---

## ğŸ§¹ ë°ì´í„° ì „ì²˜ë¦¬ ë° ì •ì œ

### 1. í…ìŠ¤íŠ¸ ë°ì´í„° ì •ì œ

```python
# ì¢…ëª©ëª…ì—ì„œ ë¶ˆí•„ìš”í•œ ë¬¸ì ì œê±°
df['ì¢…ëª©ëª…'] = df['ì¢…ëª©ëª…'].str.replace('\n', '').str.strip()
print("ì¢…ëª©ëª… ì •ì œ í›„:")
print(df['ì¢…ëª©ëª…'].head(3))
```

### 2. ìˆ«ì ë°ì´í„° ì „ì²˜ë¦¬ í•¨ìˆ˜

```python
def clean_change_direction(val):
    """ì „ì¼ë¹„ ë°ì´í„° ì „ìš© ì „ì²˜ë¦¬ í•¨ìˆ˜"""
    if pd.isna(val):
        return pd.NA
    
    val = str(val)
    # ì½¤ë§ˆ ì œê±°, ìƒìŠ¹/í•˜ë½ ê¸°í˜¸ ë³€í™˜
    val = val.replace(',', '').replace('ìƒìŠ¹', '+').replace('í•˜ë½', '-')
    # ìˆ«ì, ì , í”ŒëŸ¬ìŠ¤, ë§ˆì´ë„ˆìŠ¤ë§Œ ë‚¨ê¸°ê¸°
    val = re.sub(r'[^\d\.\-\+]', '', val)
    
    try:
        return float(val)
    except ValueError:
        return pd.NA

def clean_numeric_column(series):
    """ì¼ë°˜ ìˆ«ìí˜• ì»¬ëŸ¼ ì „ì²˜ë¦¬ í•¨ìˆ˜"""
    return (
        series.astype(str)
        .str.replace(',', '', regex=False)      # ì½¤ë§ˆ ì œê±°
        .str.replace('%', '', regex=False)      # í¼ì„¼íŠ¸ ì œê±°
        .replace(['', '-', 'N/A', 'nan'], pd.NA)  # ë¹ˆ ê°’ì„ NAë¡œ
        .apply(lambda x: pd.to_numeric(x, errors='coerce'))  # ìˆ«ì ë³€í™˜
    )

# ì „ì¼ë¹„ ë°ì´í„° ì „ì²˜ë¦¬ ì ìš©
df['ì „ì¼ë¹„'] = df['ì „ì¼ë¹„'].apply(clean_change_direction)

# ìˆ«ìí˜• ì»¬ëŸ¼ë“¤ ì¼ê´„ ì „ì²˜ë¦¬
numeric_cols = ['í˜„ì¬ê°€', 'ì „ì¼ë¹„', 'ë“±ë½ë¥ ', 'ì•¡ë©´ê°€', 'ì‹œê°€ì´ì•¡', 'ìƒì¥ì£¼ì‹ìˆ˜', 'ê±°ë˜ëŸ‰', 'PER', 'ROE']

for col in numeric_cols:
    if col in df.columns:
        df[col] = clean_numeric_column(df[col])

print("ìˆ«ì ì»¬ëŸ¼ ì¼ê´„ ì²˜ë¦¬ ì™„ë£Œ")
print(df[['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ì „ì¼ë¹„']].head(3))
```

---

## ğŸ“Š ë°ì´í„° ë¶„ì„ ë° í™œìš© ì˜ˆì œ

### 1. ê¸°ë³¸ í†µê³„ ì •ë³´ í™•ì¸

```python
print("=== ê¸°ë³¸ í†µê³„ ì •ë³´ ===")
print(df.describe())

print("\n=== ì‹œê°€ì´ì•¡ ê¸°ì¤€ ìƒìœ„ 5ê°œ ì¢…ëª© ===")
top_5_by_market_cap = df.dropna(subset=['ì‹œê°€ì´ì•¡']).sort_values(
    by='ì‹œê°€ì´ì•¡', ascending=False
).head(5)
print(top_5_by_market_cap[['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ì‹œê°€ì´ì•¡']])

print("\n=== ê±°ë˜ëŸ‰ ê¸°ì¤€ ìƒìœ„ 5ê°œ ì¢…ëª© ===")
top_5_by_volume = df.dropna(subset=['ê±°ë˜ëŸ‰']).sort_values(
    by='ê±°ë˜ëŸ‰', ascending=False
).head(5)
print(top_5_by_volume[['ì¢…ëª©ëª…', 'ê±°ë˜ëŸ‰', 'í˜„ì¬ê°€']])
```

### 2. ì¡°ê±´ë¶€ í•„í„°ë§ ë° ë¶„ì„

```python
# ê³ ê°€ ì£¼ì‹ í•„í„°ë§ (í˜„ì¬ê°€ 100,000ì› ì´ìƒ)
high_price_stocks = df[df['í˜„ì¬ê°€'] >= 100000]
print(f"\n=== ê³ ê°€ì£¼ ë¶„ì„ (10ë§Œì› ì´ìƒ, {len(high_price_stocks)}ê°œ) ===")
print(high_price_stocks[['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ì‹œê°€ì´ì•¡']].head())

# ìƒìŠ¹ ì¢…ëª© ë¶„ì„
rising_stocks = df[df['ì „ì¼ë¹„'] > 0]
print(f"\n=== ìƒìŠ¹ ì¢…ëª© ë¶„ì„ ({len(rising_stocks)}ê°œ) ===")
if len(rising_stocks) > 0:
    print("í‰ê·  ìƒìŠ¹í­:", rising_stocks['ì „ì¼ë¹„'].mean())
    print("ìƒìœ„ ìƒìŠ¹ ì¢…ëª©:")
    print(rising_stocks.sort_values('ì „ì¼ë¹„', ascending=False)[['ì¢…ëª©ëª…', 'ì „ì¼ë¹„']].head())

# í•˜ë½ ì¢…ëª© ë¶„ì„
falling_stocks = df[df['ì „ì¼ë¹„'] < 0]
print(f"\n=== í•˜ë½ ì¢…ëª© ë¶„ì„ ({len(falling_stocks)}ê°œ) ===")
if len(falling_stocks) > 0:
    print("í‰ê·  í•˜ë½í­:", falling_stocks['ì „ì¼ë¹„'].mean())
    print("í•˜ìœ„ í•˜ë½ ì¢…ëª©:")
    print(falling_stocks.sort_values('ì „ì¼ë¹„')[['ì¢…ëª©ëª…', 'ì „ì¼ë¹„']].head())
```

### 3. ê·¸ë£¹ë³„ ë¶„ì„

```python
# ê°€ê²©ëŒ€ë³„ ê·¸ë£¹ ë¶„ì„
df['ê°€ê²©ëŒ€'] = pd.cut(df['í˜„ì¬ê°€'], 
                    bins=[0, 10000, 50000, 100000, float('inf')],
                    labels=['ì €ê°€ì£¼(1ë§Œì› ë¯¸ë§Œ)', 'ì¤‘ì €ê°€ì£¼(1-5ë§Œì›)', 'ì¤‘ê³ ê°€ì£¼(5-10ë§Œì›)', 'ê³ ê°€ì£¼(10ë§Œì› ì´ìƒ)'])

price_group_analysis = df.groupby('ê°€ê²©ëŒ€').agg({
    'ì¢…ëª©ëª…': 'count',
    'í˜„ì¬ê°€': 'mean',
    'ì‹œê°€ì´ì•¡': 'mean',
    'ê±°ë˜ëŸ‰': 'mean'
}).round(2)
price_group_analysis.columns = ['ì¢…ëª© ìˆ˜', 'í‰ê·  í˜„ì¬ê°€', 'í‰ê·  ì‹œê°€ì´ì•¡', 'í‰ê·  ê±°ë˜ëŸ‰']
print("\n=== ê°€ê²©ëŒ€ë³„ ë¶„ì„ ===")
print(price_group_analysis)
```

### 4. ìƒê´€ê´€ê³„ ë¶„ì„

```python
# ì£¼ìš” ì§€í‘œ ê°„ ìƒê´€ê´€ê³„ ë¶„ì„
correlation_cols = ['í˜„ì¬ê°€', 'ì‹œê°€ì´ì•¡', 'ê±°ë˜ëŸ‰', 'PER', 'ROE']
available_cols = [col for col in correlation_cols if col in df.columns]

if len(available_cols) >= 2:
    correlation_matrix = df[available_cols].corr()
    print("\n=== ì£¼ìš” ì§€í‘œ ìƒê´€ê´€ê³„ ===")
    print(correlation_matrix)
```

---

## ğŸ“ˆ ë°ì´í„° ì‹œê°í™” ì¤€ë¹„

### 1. ì‹œê°í™”ë¥¼ ìœ„í•œ ë°ì´í„° ì¤€ë¹„

```python
import matplotlib.pyplot as plt
import seaborn as sns
plt.rcParams['font.family'] = 'DejaVu Sans'  # í•œê¸€ í°íŠ¸ ì„¤ì • (í™˜ê²½ì— ë”°ë¼ ì¡°ì •)

# ìƒìœ„ 10ê°œ ì¢…ëª© ì‹œê°€ì´ì•¡ ì‹œê°í™” ë°ì´í„° ì¤€ë¹„
top_10_market_cap = df.dropna(subset=['ì‹œê°€ì´ì•¡']).sort_values(
    by='ì‹œê°€ì´ì•¡', ascending=False
).head(10)

print("=== ì‹œê°í™”ìš© ë°ì´í„° (ìƒìœ„ 10ê°œ ì¢…ëª©) ===")
print(top_10_market_cap[['ì¢…ëª©ëª…', 'ì‹œê°€ì´ì•¡']])
```

### 2. ê°„ë‹¨í•œ ì‹œê°í™” ì˜ˆì œ

```python
# ì£¼ì˜: ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” matplotlib, seaborn ì„¤ì¹˜ ë° í•œê¸€ í°íŠ¸ ì„¤ì • í•„ìš”

def create_visualization_code():
    """ì‹œê°í™” ì½”ë“œ ì˜ˆì œ (ì‹¤í–‰ìš©)"""
    code = '''
# ì‹œê°€ì´ì•¡ ìƒìœ„ 10ê°œ ì¢…ëª© ë°”ì°¨íŠ¸
plt.figure(figsize=(12, 6))
plt.bar(top_10_market_cap['ì¢…ëª©ëª…'], top_10_market_cap['ì‹œê°€ì´ì•¡'])
plt.title('ì‹œê°€ì´ì•¡ ìƒìœ„ 10ê°œ ì¢…ëª©')
plt.xlabel('ì¢…ëª©ëª…')
plt.ylabel('ì‹œê°€ì´ì•¡')
plt.xticks(rotation=45)
plt.tight_layout()
plt.show()

# í˜„ì¬ê°€ ë¶„í¬ íˆìŠ¤í† ê·¸ë¨
plt.figure(figsize=(10, 6))
plt.hist(df['í˜„ì¬ê°€'].dropna(), bins=50, edgecolor='black')
plt.title('í˜„ì¬ê°€ ë¶„í¬')
plt.xlabel('í˜„ì¬ê°€')
plt.ylabel('ë¹ˆë„')
plt.show()

# ì „ì¼ë¹„ ë¶„í¬ (ìƒìŠ¹/í•˜ë½)
rising_count = len(df[df['ì „ì¼ë¹„'] > 0])
falling_count = len(df[df['ì „ì¼ë¹„'] < 0])
unchanged_count = len(df[df['ì „ì¼ë¹„'] == 0])

plt.figure(figsize=(8, 6))
plt.pie([rising_count, falling_count, unchanged_count], 
        labels=['ìƒìŠ¹', 'í•˜ë½', 'ë³´í•©'], 
        autopct='%1.1f%%')
plt.title('ì£¼ê°€ ë“±ë½ ë¶„í¬')
plt.show()
'''
    return code

visualization_code = create_visualization_code()
print("\n=== ì‹œê°í™” ì½”ë“œ ì˜ˆì œ ===")
print(visualization_code)
```

---

## ğŸ” ê³ ê¸‰ ë¶„ì„ ì˜ˆì œ

### 1. íˆ¬ì ì§€í‘œ ê³„ì‚°

```python
def calculate_investment_metrics(df):
    """íˆ¬ì ê´€ë ¨ ì§€í‘œ ê³„ì‚°"""
    result_df = df.copy()
    
    # ì‹œê°€ì´ì•¡ ëŒ€ë¹„ ê±°ë˜ëŸ‰ ë¹„ìœ¨ (ìœ ë™ì„± ì§€í‘œ)
    if 'ì‹œê°€ì´ì•¡' in df.columns and 'ê±°ë˜ëŸ‰' in df.columns:
        result_df['ê±°ë˜ëŸ‰_ë¹„ìœ¨'] = (result_df['ê±°ë˜ëŸ‰'] / result_df['ì‹œê°€ì´ì•¡'] * 100).round(4)
    
    # ë“±ë½ë¥  ê¸°ë°˜ ë³€ë™ì„± êµ¬ê°„ ë¶„ë¥˜
    if 'ë“±ë½ë¥ ' in df.columns:
        result_df['ë³€ë™ì„±_êµ¬ê°„'] = pd.cut(
            result_df['ë“±ë½ë¥ '].abs(),
            bins=[0, 2, 5, 10, float('inf')],
            labels=['ë‚®ìŒ(2% ë¯¸ë§Œ)', 'ë³´í†µ(2-5%)', 'ë†’ìŒ(5-10%)', 'ë§¤ìš°ë†’ìŒ(10% ì´ìƒ)']
        )
    
    return result_df

# íˆ¬ì ì§€í‘œ ê³„ì‚° ì ìš©
df_with_metrics = calculate_investment_metrics(df)

print("=== íˆ¬ì ì§€í‘œê°€ ì¶”ê°€ëœ ë°ì´í„° ===")
if 'ê±°ë˜ëŸ‰_ë¹„ìœ¨' in df_with_metrics.columns:
    print("ê±°ë˜ëŸ‰ ë¹„ìœ¨ ìƒìœ„ 5ê°œ:")
    top_liquidity = df_with_metrics.dropna(subset=['ê±°ë˜ëŸ‰_ë¹„ìœ¨']).sort_values(
        'ê±°ë˜ëŸ‰_ë¹„ìœ¨', ascending=False
    ).head(5)
    print(top_liquidity[['ì¢…ëª©ëª…', 'ê±°ë˜ëŸ‰_ë¹„ìœ¨']])

if 'ë³€ë™ì„±_êµ¬ê°„' in df_with_metrics.columns:
    print("\në³€ë™ì„± êµ¬ê°„ë³„ ì¢…ëª© ìˆ˜:")
    print(df_with_metrics['ë³€ë™ì„±_êµ¬ê°„'].value_counts())
```

### 2. ìŠ¤í¬ë¦¬ë‹ (ì¢…ëª© ì„ ë³„) ì˜ˆì œ

```python
def screen_stocks(df, criteria):
    """ë‹¤ì¤‘ ì¡°ê±´ì„ ì´ìš©í•œ ì¢…ëª© ìŠ¤í¬ë¦¬ë‹"""
    filtered_df = df.copy()
    
    for criterion, value in criteria.items():
        if criterion == 'min_market_cap':
            filtered_df = filtered_df[filtered_df['ì‹œê°€ì´ì•¡'] >= value]
        elif criterion == 'max_per':
            filtered_df = filtered_df[filtered_df['PER'] <= value]
        elif criterion == 'min_roe':
            filtered_df = filtered_df[filtered_df['ROE'] >= value]
        elif criterion == 'min_volume':
            filtered_df = filtered_df[filtered_df['ê±°ë˜ëŸ‰'] >= value]
    
    return filtered_df

# ìŠ¤í¬ë¦¬ë‹ ì¡°ê±´ ì„¤ì •
screening_criteria = {
    'min_market_cap': 1000000,  # ì‹œê°€ì´ì•¡ 100ë§Œ ì´ìƒ
    'max_per': 15,              # PER 15 ì´í•˜
    'min_roe': 5                # ROE 5% ì´ìƒ
}

screened_stocks = screen_stocks(df, screening_criteria)
print(f"\n=== ìŠ¤í¬ë¦¬ë‹ ê²°ê³¼ ({len(screened_stocks)}ê°œ ì¢…ëª©) ===")
if len(screened_stocks) > 0:
    print(screened_stocks[['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ì‹œê°€ì´ì•¡', 'PER', 'ROE']].head(10))
else:
    print("ì¡°ê±´ì— ë§ëŠ” ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.")
```

### 3. í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„± ì˜ˆì œ

```python
def create_sample_portfolio(df, portfolio_size=5, weighting_method='equal'):
    """ìƒ˜í”Œ í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„±"""
    
    # ê¸°ë³¸ í•„í„°ë§ (ê²°ì¸¡ê°’ì´ ì ì€ ì¢…ëª© ì„ íƒ)
    clean_df = df.dropna(subset=['í˜„ì¬ê°€', 'ì‹œê°€ì´ì•¡'])
    
    if len(clean_df) < portfolio_size:
        return None
    
    if weighting_method == 'market_cap':
        # ì‹œê°€ì´ì•¡ ê°€ì¤‘ ë°©ì‹
        selected = clean_df.nlargest(portfolio_size, 'ì‹œê°€ì´ì•¡')
        total_market_cap = selected['ì‹œê°€ì´ì•¡'].sum()
        selected['ë¹„ì¤‘'] = (selected['ì‹œê°€ì´ì•¡'] / total_market_cap * 100).round(2)
    else:
        # ë™ì¼ ê°€ì¤‘ ë°©ì‹
        selected = clean_df.sample(n=portfolio_size) if len(clean_df) >= portfolio_size else clean_df
        selected['ë¹„ì¤‘'] = round(100 / len(selected), 2)
    
    return selected[['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ì‹œê°€ì´ì•¡', 'ë¹„ì¤‘']]

# í¬íŠ¸í´ë¦¬ì˜¤ ìƒì„± ì˜ˆì œ
print("\n=== ìƒ˜í”Œ í¬íŠ¸í´ë¦¬ì˜¤ (ì‹œê°€ì´ì•¡ ê°€ì¤‘) ===")
market_cap_portfolio = create_sample_portfolio(df, portfolio_size=5, weighting_method='market_cap')
if market_cap_portfolio is not None:
    print(market_cap_portfolio)
    print(f"ì´ ë¹„ì¤‘: {market_cap_portfolio['ë¹„ì¤‘'].sum()}%")

print("\n=== ìƒ˜í”Œ í¬íŠ¸í´ë¦¬ì˜¤ (ë™ì¼ ê°€ì¤‘) ===")
equal_weight_portfolio = create_sample_portfolio(df, portfolio_size=5, weighting_method='equal')
if equal_weight_portfolio is not None:
    print(equal_weight_portfolio)
    print(f"ì´ ë¹„ì¤‘: {equal_weight_portfolio['ë¹„ì¤‘'].sum()}%")
```

---

## ğŸ’¾ ë¶„ì„ ê²°ê³¼ ì €ì¥ ë° ë³´ê³ 

### 1. ë¶„ì„ ê²°ê³¼ë¥¼ Excelë¡œ ì €ì¥

```python
def save_analysis_to_excel(df, filename='ì£¼ì‹ë¶„ì„ê²°ê³¼.xlsx'):
    """ë¶„ì„ ê²°ê³¼ë¥¼ Excel íŒŒì¼ë¡œ ì €ì¥"""
    
    with pd.ExcelWriter(filename, engine='openpyxl') as writer:
        # ì „ì²´ ë°ì´í„°
        df.to_excel(writer, sheet_name='ì „ì²´ë°ì´í„°', index=False)
        
        # ì‹œê°€ì´ì•¡ ìƒìœ„ 20ê°œ
        top_20 = df.dropna(subset=['ì‹œê°€ì´ì•¡']).sort_values(
            'ì‹œê°€ì´ì•¡', ascending=False
        ).head(20)
        top_20.to_excel(writer, sheet_name='ì‹œê°€ì´ì•¡ìƒìœ„20', index=False)
        
        # ìƒìŠ¹ ì¢…ëª©ë§Œ
        rising = df[df['ì „ì¼ë¹„'] > 0]
        if len(rising) > 0:
            rising.to_excel(writer, sheet_name='ìƒìŠ¹ì¢…ëª©', index=False)
        
        # í•˜ë½ ì¢…ëª©ë§Œ
        falling = df[df['ì „ì¼ë¹„'] < 0]
        if len(falling) > 0:
            falling.to_excel(writer, sheet_name='í•˜ë½ì¢…ëª©', index=False)
    
    print(f"ë¶„ì„ ê²°ê³¼ê°€ '{filename}' íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")

# Excel ì €ì¥ ì‹¤í–‰
save_analysis_to_excel(df)
```

### 2. ìš”ì•½ ë³´ê³ ì„œ ìƒì„±

```python
def generate_summary_report(df):
    """ìš”ì•½ ë³´ê³ ì„œ ìƒì„±"""
    
    report = []
    report.append("=" * 50)
    report.append("ì£¼ì‹ ë°ì´í„° ë¶„ì„ ìš”ì•½ ë³´ê³ ì„œ")
    report.append("=" * 50)
    report.append(f"ë¶„ì„ ì¼ì‹œ: {pd.Timestamp.now().strftime('%Y-%m-%d %H:%M:%S')}")
    report.append(f"ì´ ì¢…ëª© ìˆ˜: {len(df)}")
    
    # ê¸°ë³¸ í†µê³„
    if 'í˜„ì¬ê°€' in df.columns:
        report.append(f"í‰ê·  í˜„ì¬ê°€: {df['í˜„ì¬ê°€'].mean():.0f}ì›")
        report.append(f"ìµœê³  í˜„ì¬ê°€: {df['í˜„ì¬ê°€'].max():.0f}ì›")
        report.append(f"ìµœì € í˜„ì¬ê°€: {df['í˜„ì¬ê°€'].min():.0f}ì›")
    
    # ë“±ë½ í˜„í™©
    if 'ì „ì¼ë¹„' in df.columns:
        rising = len(df[df['ì „ì¼ë¹„'] > 0])
        falling = len(df[df['ì „ì¼ë¹„'] < 0])
        unchanged = len(df[df['ì „ì¼ë¹„'] == 0])
        
        report.append("\n< ë“±ë½ í˜„í™© >")
        report.append(f"ìƒìŠ¹ ì¢…ëª©: {rising}ê°œ ({rising/len(df)*100:.1f}%)")
        report.append(f"í•˜ë½ ì¢…ëª©: {falling}ê°œ ({falling/len(df)*100:.1f}%)")
        report.append(f"ë³´í•© ì¢…ëª©: {unchanged}ê°œ ({unchanged/len(df)*100:.1f}%)")
    
    # ì‹œê°€ì´ì•¡ ìƒìœ„ 5ê°œ
    if 'ì‹œê°€ì´ì•¡' in df.columns:
        top_5 = df.dropna(subset=['ì‹œê°€ì´ì•¡']).nlargest(5, 'ì‹œê°€ì´ì•¡')
        report.append("\n< ì‹œê°€ì´ì•¡ ìƒìœ„ 5ê°œ ì¢…ëª© >")
        for idx, row in top_5.iterrows():
            report.append(f"{row['ì¢…ëª©ëª…']}: {row['ì‹œê°€ì´ì•¡']:,.0f}")
    
    report.append("=" * 50)
    
    return "\n".join(report)

# ìš”ì•½ ë³´ê³ ì„œ ìƒì„± ë° ì¶œë ¥
summary = generate_summary_report(df)
print(summary)

# í…ìŠ¤íŠ¸ íŒŒì¼ë¡œ ì €ì¥
with open('ì£¼ì‹ë¶„ì„_ìš”ì•½ë³´ê³ ì„œ.txt', 'w', encoding='utf-8') as f:
    f.write(summary)
print("\nìš”ì•½ ë³´ê³ ì„œê°€ 'ì£¼ì‹ë¶„ì„_ìš”ì•½ë³´ê³ ì„œ.txt' íŒŒì¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.")
```

---

## ğŸ¯ ì‹¤ë¬´ í™œìš© íŒ

### 1. ë°ì´í„° í’ˆì§ˆ ê´€ë¦¬

```python
def check_data_quality(df):
    """ë°ì´í„° í’ˆì§ˆ ì ê²€"""
    
    quality_report = {
        'ì´_í–‰ìˆ˜': len(df),
        'ì´_ì»¬ëŸ¼ìˆ˜': len(df.columns),
        'ê²°ì¸¡ê°’_ë¹„ìœ¨': (df.isnull().sum().sum() / (len(df) * len(df.columns)) * 100),
        'ì¤‘ë³µí–‰_ìˆ˜': df.duplicated().sum(),
        'ìˆ«ìì»¬ëŸ¼_ìˆ˜': len(df.select_dtypes(include=[np.number]).columns),
        'ë¬¸ìì»¬ëŸ¼_ìˆ˜': len(df.select_dtypes(include=['object']).columns)
    }
    
    print("=== ë°ì´í„° í’ˆì§ˆ ì ê²€ ê²°ê³¼ ===")
    for key, value in quality_report.items():
        if 'ë¹„ìœ¨' in key:
            print(f"{key}: {value:.2f}%")
        else:
            print(f"{key}: {value}")
    
    return quality_report

# ë°ì´í„° í’ˆì§ˆ ì ê²€ ì‹¤í–‰
quality_check = check_data_quality(df)
```

### 2. ìë™í™” í•¨ìˆ˜ ì˜ˆì œ

```python
def automated_stock_analysis(csv_file):
    """ì£¼ì‹ ë°ì´í„° ìë™ ë¶„ì„ í•¨ìˆ˜"""
    
    # 1. ë°ì´í„° ë¡œë“œ
    df = pd.read_csv(csv_file, dtype=str, index_col=False)
    
    # 2. ë°ì´í„° ì „ì²˜ë¦¬
    df = preprocess_stock_data(df)  # ì•ì„œ ì •ì˜í•œ ì „ì²˜ë¦¬ í•¨ìˆ˜ ì‚¬ìš©
    
    # 3. ê¸°ë³¸ ë¶„ì„
    analysis_results = {
        'basic_stats': df.describe(),
        'top_by_market_cap': df.nlargest(10, 'ì‹œê°€ì´ì•¡'),
        'top_by_volume': df.nlargest(10, 'ê±°ë˜ëŸ‰'),
        'rising_stocks': df[df['ì „ì¼ë¹„'] > 0],
        'falling_stocks': df[df['ì „ì¼ë¹„'] < 0]
    }
    
    # 4. ê²°ê³¼ ì €ì¥
    save_analysis_to_excel(df, f'analysis_{pd.Timestamp.now().strftime("%Y%m%d")}.xlsx')
    
    return analysis_results

# ì‚¬ìš© ì˜ˆì œ
# results = automated_stock_analysis('ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv')
```

---

## ğŸ¤–(ì¶”ê°€í•™ìŠµìŠµ) ì™„ì „ ìë™í™”: ì›ìŠ¤í†± ë¶„ì„ ì‹œìŠ¤í…œ

### ì¢…í•© ìë™í™” í•¨ìˆ˜

```python
def automated_stock_analysis(csv_file='ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv', output_dir='analysis_results'):
    """
    ì£¼ì‹ ë°ì´í„° ì™„ì „ ìë™í™” ë¶„ì„ ì‹œìŠ¤í…œ
    - ë°ì´í„° ë¡œë“œë¶€í„° ë³´ê³ ì„œ ìƒì„±ê¹Œì§€ ì›ìŠ¤í†± ì²˜ë¦¬
    """
    import os
    from datetime import datetime
    
    # ì¶œë ¥ ë””ë ‰í† ë¦¬ ìƒì„±
    if not os.path.exists(output_dir):
        os.makedirs(output_dir)
    
    print("ğŸš€ ì£¼ì‹ ë°ì´í„° ìë™ ë¶„ì„ ì‹œìŠ¤í…œ ì‹œì‘")
    print("=" * 50)
    
    try:
        # 1ë‹¨ê³„: ë°ì´í„° ë¡œë“œ ë° ì „ì²˜ë¦¬
        print("1ï¸âƒ£ ë°ì´í„° ë¡œë“œ ë° ì „ì²˜ë¦¬ ì¤‘...")
        df = pd.read_csv(csv_file, dtype=str, index_col=False)
        print(f"   âœ… ì›ë³¸ ë°ì´í„° ë¡œë“œ ì™„ë£Œ: {len(df)}ê°œ í–‰")
        
        # ì „ì²˜ë¦¬ ì ìš©
        df = apply_full_preprocessing(df)
        print(f"   âœ… ë°ì´í„° ì „ì²˜ë¦¬ ì™„ë£Œ: {len(df)}ê°œ ìœ íš¨ í–‰")
        
        # 2ë‹¨ê³„: ê¸°ë³¸ ë¶„ì„ ì‹¤í–‰
        print("\n2ï¸âƒ£ ê¸°ë³¸ ë¶„ì„ ì‹¤í–‰ ì¤‘...")
        basic_results = perform_basic_analysis(df)
        print(f"   âœ… ê¸°ë³¸ í†µê³„ ë¶„ì„ ì™„ë£Œ")
        
        # 3ë‹¨ê³„: ê³ ê¸‰ ë¶„ì„ ì‹¤í–‰
        print("\n3ï¸âƒ£ ê³ ê¸‰ ë¶„ì„ ì‹¤í–‰ ì¤‘...")
        advanced_results = perform_advanced_analysis(df)
        print(f"   âœ… íˆ¬ì ì§€í‘œ ë° í¬íŠ¸í´ë¦¬ì˜¤ ë¶„ì„ ì™„ë£Œ")
        
        # 4ë‹¨ê³„: ì‹œê°í™” ìƒì„±
        print("\n4ï¸âƒ£ ì‹œê°í™” ìƒì„± ì¤‘...")
        chart_paths = create_all_charts(df, output_dir)
        print(f"   âœ… {len(chart_paths)}ê°œ ì°¨íŠ¸ ìƒì„± ì™„ë£Œ")
        
        # 5ë‹¨ê³„: ì¢…í•© ë³´ê³ ì„œ ìƒì„±
        print("\n5ï¸âƒ£ ì¢…í•© ë³´ê³ ì„œ ìƒì„± ì¤‘...")
        report_paths = generate_comprehensive_reports(
            df, basic_results, advanced_results, output_dir
        )
        print(f"   âœ… {len(report_paths)}ê°œ ë³´ê³ ì„œ ìƒì„± ì™„ë£Œ")
        
        # 6ë‹¨ê³„: ê²°ê³¼ ìš”ì•½ ì¶œë ¥
        print("\nğŸ“Š ë¶„ì„ ì™„ë£Œ ìš”ì•½")
        print("=" * 50)
        print(f"ğŸ“ ê²°ê³¼ ì €ì¥ ìœ„ì¹˜: {output_dir}")
        print(f"ğŸ“ˆ ë¶„ì„ ì¢…ëª© ìˆ˜: {len(df)}")
        print(f"ğŸ“‹ ìƒì„±ëœ íŒŒì¼:")
        
        all_files = []
        for root, dirs, files in os.walk(output_dir):
            for file in files:
                all_files.append(os.path.join(root, file))
        
        for i, file_path in enumerate(all_files, 1):
            print(f"   {i}. {os.path.basename(file_path)}")
        
        return {
            'dataframe': df,
            'basic_results': basic_results,
            'advanced_results': advanced_results,
            'output_files': all_files
        }
        
    except Exception as e:
        print(f"âŒ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}")
        return None

def apply_full_preprocessing(df):
    """ì „ì²´ ë°ì´í„° ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸"""
    
    # ê¸°ë³¸ ì •ì œ
    df['ì¢…ëª©ëª…'] = df['ì¢…ëª©ëª…'].str.replace('\n', '').str.strip()
    
    # ì „ì¼ë¹„ ì „ì²˜ë¦¬
    df['ì „ì¼ë¹„'] = df['ì „ì¼ë¹„'].apply(clean_change_direction)
    
    # ìˆ«ìí˜• ì»¬ëŸ¼ ì „ì²˜ë¦¬
    numeric_cols = ['í˜„ì¬ê°€', 'ë“±ë½ë¥ ', 'ì•¡ë©´ê°€', 'ì‹œê°€ì´ì•¡', 'ìƒì¥ì£¼ì‹ìˆ˜', 
                   'ì™¸êµ­ì¸ë¹„ìœ¨', 'ê±°ë˜ëŸ‰', 'PER', 'ROE']
    
    for col in numeric_cols:
        if col in df.columns:
            df[col] = clean_numeric_column(df[col])
    
    return df

def perform_basic_analysis(df):
    """ê¸°ë³¸ ë¶„ì„ ì‹¤í–‰"""
    
    results = {}
    
    # ê¸°ë³¸ í†µê³„
    results['basic_stats'] = df.describe()
    
    # ìƒìœ„ ì¢…ëª©ë“¤
    results['top_market_cap'] = df.dropna(subset=['ì‹œê°€ì´ì•¡']).nlargest(10, 'ì‹œê°€ì´ì•¡')
    results['top_volume'] = df.dropna(subset=['ê±°ë˜ëŸ‰']).nlargest(10, 'ê±°ë˜ëŸ‰')
    results['top_price'] = df.dropna(subset=['í˜„ì¬ê°€']).nlargest(10, 'í˜„ì¬ê°€')
    
    # ë“±ë½ í˜„í™©
    results['rising_stocks'] = df[df['ì „ì¼ë¹„'] > 0]
    results['falling_stocks'] = df[df['ì „ì¼ë¹„'] < 0]
    results['unchanged_stocks'] = df[df['ì „ì¼ë¹„'] == 0]
    
    return results

def perform_advanced_analysis(df):
    """ê³ ê¸‰ ë¶„ì„ ì‹¤í–‰"""
    
    results = {}
    
    # íˆ¬ì ì§€í‘œ ê³„ì‚°
    df_with_metrics = calculate_investment_metrics(df)
    results['investment_metrics'] = df_with_metrics
    
    # ì¢…ëª© ìŠ¤í¬ë¦¬ë‹
    screening_criteria = {
        'min_market_cap': 1000000,
        'max_per': 15,
        'min_roe': 5
    }
    results['screened_stocks'] = screen_stocks(df, screening_criteria)
    
    # í¬íŠ¸í´ë¦¬ì˜¤ êµ¬ì„±
    results['market_cap_portfolio'] = create_sample_portfolio(
        df, portfolio_size=10, weighting_method='market_cap'
    )
    results['equal_weight_portfolio'] = create_sample_portfolio(
        df, portfolio_size=10, weighting_method='equal'
    )
    
    return results

def create_all_charts(df, output_dir):
    """ëª¨ë“  ì°¨íŠ¸ ìƒì„± (ì‹œê°í™” ì½”ë“œ í…œí”Œë¦¿)"""
    
    chart_paths = []
    
    # ì£¼ì˜: ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” matplotlib ì„¤ì¹˜ í•„ìš”
    chart_code_templates = {
        'market_cap_chart': '''
# ì‹œê°€ì´ì•¡ ìƒìœ„ 10ê°œ ì¢…ëª©
top_10 = df.nlargest(10, 'ì‹œê°€ì´ì•¡')
plt.figure(figsize=(12, 6))
plt.bar(top_10['ì¢…ëª©ëª…'], top_10['ì‹œê°€ì´ì•¡'])
plt.title('ì‹œê°€ì´ì•¡ ìƒìœ„ 10ê°œ ì¢…ëª©')
plt.xticks(rotation=45)
plt.tight_layout()
plt.savefig(f'{output_dir}/ì‹œê°€ì´ì•¡_ìƒìœ„ì¢…ëª©.png')
plt.close()
        ''',
        
        'price_distribution': '''
# í˜„ì¬ê°€ ë¶„í¬ íˆìŠ¤í† ê·¸ë¨
plt.figure(figsize=(10, 6))
plt.hist(df['í˜„ì¬ê°€'].dropna(), bins=50, edgecolor='black')
plt.title('í˜„ì¬ê°€ ë¶„í¬')
plt.xlabel('í˜„ì¬ê°€')
plt.ylabel('ë¹ˆë„')
plt.savefig(f'{output_dir}/í˜„ì¬ê°€_ë¶„í¬.png')
plt.close()
        ''',
        
        'change_pie_chart': '''
# ë“±ë½ ë¹„ìœ¨ íŒŒì´ì°¨íŠ¸
rising = len(df[df['ì „ì¼ë¹„'] > 0])
falling = len(df[df['ì „ì¼ë¹„'] < 0])
unchanged = len(df[df['ì „ì¼ë¹„'] == 0])

plt.figure(figsize=(8, 8))
plt.pie([rising, falling, unchanged], 
        labels=['ìƒìŠ¹', 'í•˜ë½', 'ë³´í•©'],
        autopct='%1.1f%%')
plt.title('ì£¼ê°€ ë“±ë½ ë¶„í¬')
plt.savefig(f'{output_dir}/ë“±ë½_ë¶„í¬.png')
plt.close()
        '''
    }
    
    # ì°¨íŠ¸ ì½”ë“œ í…œí”Œë¦¿ì„ íŒŒì¼ë¡œ ì €ì¥
    for chart_name, code in chart_code_templates.items():
        code_path = os.path.join(output_dir, f'{chart_name}_code.py')
        with open(code_path, 'w', encoding='utf-8') as f:
            f.write(f"import matplotlib.pyplot as plt\nimport pandas as pd\n\n")
            f.write(f"# {chart_name} ìƒì„± ì½”ë“œ\n")
            f.write(f"df = pd.read_csv('ì „ì²˜ë¦¬ëœ_ë°ì´í„°.csv')\n")
            f.write(code)
        chart_paths.append(code_path)
    
    return chart_paths

def generate_comprehensive_reports(df, basic_results, advanced_results, output_dir):
    """ì¢…í•© ë³´ê³ ì„œ ìƒì„±"""
    
    report_paths = []
    timestamp = datetime.now().strftime('%Y%m%d_%H%M%S')
    
    # 1. Excel ì¢…í•© ë¶„ì„ íŒŒì¼
    excel_path = os.path.join(output_dir, f'ì£¼ì‹ë¶„ì„_ì¢…í•©ë³´ê³ ì„œ_{timestamp}.xlsx')
    
    with pd.ExcelWriter(excel_path, engine='openpyxl') as writer:
        # ì „ì²´ ë°ì´í„°
        df.to_excel(writer, sheet_name='ì „ì²´ë°ì´í„°', index=False)
        
        # ê¸°ë³¸ ë¶„ì„ ê²°ê³¼ë“¤
        basic_results['basic_stats'].to_excel(writer, sheet_name='ê¸°ë³¸í†µê³„')
        basic_results['top_market_cap'][['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ì‹œê°€ì´ì•¡']].to_excel(
            writer, sheet_name='ì‹œê°€ì´ì•¡ìƒìœ„', index=False)
        basic_results['top_volume'][['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ê±°ë˜ëŸ‰']].to_excel(
            writer, sheet_name='ê±°ë˜ëŸ‰ìƒìœ„', index=False)
        
        # ë“±ë½ í˜„í™©
        if len(basic_results['rising_stocks']) > 0:
            basic_results['rising_stocks'][['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ì „ì¼ë¹„']].to_excel(
                writer, sheet_name='ìƒìŠ¹ì¢…ëª©', index=False)
        
        if len(basic_results['falling_stocks']) > 0:
            basic_results['falling_stocks'][['ì¢…ëª©ëª…', 'í˜„ì¬ê°€', 'ì „ì¼ë¹„']].to_excel(
                writer, sheet_name='í•˜ë½ì¢…ëª©', index=False)
        
        # ê³ ê¸‰ ë¶„ì„ ê²°ê³¼
        if advanced_results['screened_stocks'] is not None and len(advanced_results['screened_stocks']) > 0:
            advanced_results['screened_stocks'].to_excel(
                writer, sheet_name='ì„ ë³„ëœì¢…ëª©', index=False)
        
        if advanced_results['market_cap_portfolio'] is not None:
            advanced_results['market_cap_portfolio'].to_excel(
                writer, sheet_name='ì¶”ì²œí¬íŠ¸í´ë¦¬ì˜¤', index=False)
    
    report_paths.append(excel_path)
    
    # 2. í…ìŠ¤íŠ¸ ìš”ì•½ ë³´ê³ ì„œ
    txt_path = os.path.join(output_dir, f'ë¶„ì„ìš”ì•½ë³´ê³ ì„œ_{timestamp}.txt')
    summary_report = generate_detailed_summary(df, basic_results, advanced_results)
    
    with open(txt_path, 'w', encoding='utf-8') as f:
        f.write(summary_report)
    
    report_paths.append(txt_path)
    
    # 3. ì „ì²˜ë¦¬ëœ ë°ì´í„° ì €ì¥
    processed_data_path = os.path.join(output_dir, 'ì „ì²˜ë¦¬ëœ_ë°ì´í„°.csv')
    df.to_csv(processed_data_path, index=False, encoding='utf-8-sig')
    report_paths.append(processed_data_path)
    
    return report_paths

def generate_detailed_summary(df, basic_results, advanced_results):
    """ìƒì„¸ ìš”ì•½ ë³´ê³ ì„œ ìƒì„±"""
    
    report = []
    report.append("=" * 60)
    report.append("ğŸ“ˆ ì£¼ì‹ ë°ì´í„° ì¢…í•© ë¶„ì„ ë³´ê³ ì„œ")
    report.append("=" * 60)
    report.append(f"ğŸ“… ë¶„ì„ ì¼ì‹œ: {datetime.now().strftime('%Yë…„ %mì›” %dì¼ %Hì‹œ %Më¶„')}")
    report.append(f"ğŸ“Š ë¶„ì„ ëŒ€ìƒ: {len(df)}ê°œ ì¢…ëª©")
    report.append("")
    
    # 1. ì „ì²´ í˜„í™©
    report.append("ğŸ” 1. ì „ì²´ ì‹œì¥ í˜„í™©")
    report.append("-" * 30)
    if 'í˜„ì¬ê°€' in df.columns:
        avg_price = df['í˜„ì¬ê°€'].mean()
        max_price = df['í˜„ì¬ê°€'].max()
        min_price = df['í˜„ì¬ê°€'].min()
        report.append(f"â€¢ í‰ê·  ì£¼ê°€: {avg_price:,.0f}ì›")
        report.append(f"â€¢ ìµœê³  ì£¼ê°€: {max_price:,.0f}ì›")
        report.append(f"â€¢ ìµœì € ì£¼ê°€: {min_price:,.0f}ì›")
    
    # 2. ë“±ë½ í˜„í™©
    report.append("\nğŸ“Š 2. ë“±ë½ í˜„í™©")
    report.append("-" * 30)
    rising_count = len(basic_results['rising_stocks'])
    falling_count = len(basic_results['falling_stocks'])
    unchanged_count = len(basic_results['unchanged_stocks'])
    total_count = rising_count + falling_count + unchanged_count
    
    if total_count > 0:
        report.append(f"â€¢ ìƒìŠ¹ ì¢…ëª©: {rising_count}ê°œ ({rising_count/total_count*100:.1f}%)")
        report.append(f"â€¢ í•˜ë½ ì¢…ëª©: {falling_count}ê°œ ({falling_count/total_count*100:.1f}%)")
        report.append(f"â€¢ ë³´í•© ì¢…ëª©: {unchanged_count}ê°œ ({unchanged_count/total_count*100:.1f}%)")
    
    # 3. ìƒìœ„ ì¢…ëª©
    report.append("\nğŸ† 3. ì£¼ìš” ìƒìœ„ ì¢…ëª©")
    report.append("-" * 30)
    report.append("[ ì‹œê°€ì´ì•¡ ìƒìœ„ 5ê°œ ]")
    top_5_market = basic_results['top_market_cap'].head(5)
    for idx, row in top_5_market.iterrows():
        report.append(f"  {row['ì¢…ëª©ëª…']}: {row['ì‹œê°€ì´ì•¡']:,.0f}")
    
    report.append("\n[ ê±°ë˜ëŸ‰ ìƒìœ„ 5ê°œ ]")
    top_5_volume = basic_results['top_volume'].head(5)
    for idx, row in top_5_volume.iterrows():
        report.append(f"  {row['ì¢…ëª©ëª…']}: {row['ê±°ë˜ëŸ‰']:,.0f}")
    
    # 4. íˆ¬ì ì¶”ì²œ
    report.append("\nğŸ’¡ 4. íˆ¬ì ê´€ì  ë¶„ì„")
    report.append("-" * 30)
    
    if advanced_results['screened_stocks'] is not None and len(advanced_results['screened_stocks']) > 0:
        screened_count = len(advanced_results['screened_stocks'])
        report.append(f"â€¢ íˆ¬ì ê¸°ì¤€ ì¶©ì¡± ì¢…ëª©: {screened_count}ê°œ")
        report.append("  (ì‹œê°€ì´ì•¡ 100ë§Œ ì´ìƒ, PER 15 ì´í•˜, ROE 5% ì´ìƒ)")
        
        if screened_count <= 5:
            report.append("  ì¶”ì²œ ì¢…ëª©:")
            for idx, row in advanced_results['screened_stocks'].iterrows():
                report.append(f"    - {row['ì¢…ëª©ëª…']}")
    else:
        report.append("â€¢ ì„¤ì •ëœ íˆ¬ì ê¸°ì¤€ì„ ì¶©ì¡±í•˜ëŠ” ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.")
    
    # 5. í¬íŠ¸í´ë¦¬ì˜¤ ì œì•ˆ
    if advanced_results['market_cap_portfolio'] is not None:
        report.append("\nğŸ“‹ 5. ì¶”ì²œ í¬íŠ¸í´ë¦¬ì˜¤ (ì‹œê°€ì´ì•¡ ê°€ì¤‘)")
        report.append("-" * 30)
        portfolio = advanced_results['market_cap_portfolio']
        for idx, row in portfolio.iterrows():
            report.append(f"â€¢ {row['ì¢…ëª©ëª…']}: {row['ë¹„ì¤‘']}%")
    
    report.append("\n" + "=" * 60)
    report.append("â€» ë³¸ ë¶„ì„ì€ ì°¸ê³ ìš©ì´ë©°, íˆ¬ì ê²°ì •ì€ ì‹ ì¤‘íˆ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.")
    report.append("=" * 60)
    
    return "\n".join(report)

# ğŸš€ ìë™í™” ì‹œìŠ¤í…œ ì‹¤í–‰ í•¨ìˆ˜
def run_complete_analysis(csv_file='ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv'):
    """
    ì™„ì „ ìë™í™” ë¶„ì„ ì‹¤í–‰
    ì‚¬ìš©ë²•: run_complete_analysis('ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv')
    """
    
    print("ğŸ¯ ì£¼ì‹ ë°ì´í„° ì›ìŠ¤í†± ë¶„ì„ ì‹œìŠ¤í…œ")
    print("ğŸ”„ ëª¨ë“  ë¶„ì„ê³¼ì •ì„ ìë™ìœ¼ë¡œ ì‹¤í–‰í•©ë‹ˆë‹¤...")
    
    # ì „ì²´ ë¶„ì„ ì‹¤í–‰
    results = automated_stock_analysis(csv_file)
    
    if results:
        print("\nğŸ‰ ë¶„ì„ ì™„ë£Œ!")
        print("ğŸ“‚ ìƒì„±ëœ íŒŒì¼ë“¤ì„ í™•ì¸í•˜ì„¸ìš”.")
        print("\nğŸ’¡ í™œìš© íŒ:")
        print("  1. Excel íŒŒì¼ë¡œ ìƒì„¸ ë°ì´í„° í™•ì¸")
        print("  2. í…ìŠ¤íŠ¸ ë³´ê³ ì„œë¡œ í•µì‹¬ ì¸ì‚¬ì´íŠ¸ íŒŒì•…")
        print("  3. ì°¨íŠ¸ ì½”ë“œ ì‹¤í–‰ìœ¼ë¡œ ì‹œê°í™” ìƒì„±")
        
        return results
    else:
        print("âŒ ë¶„ì„ ì‹¤í–‰ ì¤‘ ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.")
        return None

# ì‹¤í–‰ ì˜ˆì‹œ
# results = run_complete_analysis('ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv')
```

### ìë™í™” ì‹œìŠ¤í…œ íŠ¹ì§•

#### ğŸ¯ **ì›ìŠ¤í†± ë¶„ì„**
- ë°ì´í„° ë¡œë“œ â†’ ì „ì²˜ë¦¬ â†’ ë¶„ì„ â†’ ì‹œê°í™” â†’ ë³´ê³ ì„œ ìƒì„±ê¹Œì§€ í•œ ë²ˆì—
- ëª¨ë“  ì¤‘ê°„ ê³¼ì • ìë™ ì €ì¥ ë° ë°±ì—…

#### ğŸ“Š **ìƒì„±ë˜ëŠ” ê²°ê³¼ë¬¼**
1. **Excel ì¢…í•© ë³´ê³ ì„œ** - ëª¨ë“  ë¶„ì„ ê²°ê³¼ë¥¼ ì‹œíŠ¸ë³„ë¡œ ì •ë¦¬
2. **í…ìŠ¤íŠ¸ ìš”ì•½ ë³´ê³ ì„œ** - í•µì‹¬ ì¸ì‚¬ì´íŠ¸ì™€ íˆ¬ì ê´€ì  ì •ë¦¬
3. **ì‹œê°í™” ì½”ë“œ íŒŒì¼** - ë°”ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•œ ì°¨íŠ¸ ìƒì„± ì½”ë“œ
4. **ì „ì²˜ë¦¬ëœ ë°ì´í„°** - ì¶”ê°€ ë¶„ì„ìš© ì •ì œëœ CSV íŒŒì¼

#### ğŸ”§ **ì‚¬ìš©ë²•**
```python
# ë‹¨ í•œ ì¤„ë¡œ ëª¨ë“  ë¶„ì„ ì™„ë£Œ
results = run_complete_analysis('ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv')

# ë˜ëŠ” ë” ìƒì„¸í•œ ì œì–´ë¥¼ ì›í•  ê²½ìš°
results = automated_stock_analysis(
    csv_file='ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv',
    output_dir='ë‚´ê°€_ì›í•˜ëŠ”_í´ë”ëª…'
)
```

ì´ ìë™í™” ì‹œìŠ¤í…œìœ¼ë¡œ **ë³µì¡í•œ ì£¼ì‹ ë¶„ì„ì„ ë‹¨ ëª‡ ë¶„ë§Œì— ì™„ë£Œ**í•˜ê³ , **ì „ë¬¸ì ì¸ ìˆ˜ì¤€ì˜ ë³´ê³ ì„œ**ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸš€

---

## ğŸ“š í•µì‹¬ ìš”ì•½

### ì½ì–´ì˜¨ ë°ì´í„° í™œìš© ë‹¨ê³„

1. **ë°ì´í„° ë¡œë“œ ë° ì ê²€**
   - CSV ì½ê¸°, êµ¬ì¡° íŒŒì•…, ê²°ì¸¡ê°’ í™•ì¸

2. **ë°ì´í„° ì „ì²˜ë¦¬**
   - í…ìŠ¤íŠ¸ ì •ì œ, ìˆ«ìí˜• ë³€í™˜, íŠ¹ìˆ˜ë¬¸ì ì²˜ë¦¬

3. **ê¸°ë³¸ ë¶„ì„**
   - í†µê³„ ì •ë³´, ì •ë ¬, í•„í„°ë§

4. **ê³ ê¸‰ ë¶„ì„**
   - ê·¸ë£¹ë³„ ë¶„ì„, ìƒê´€ê´€ê³„, íˆ¬ì ì§€í‘œ ê³„ì‚°

5. **ì‹œê°í™” ë° ë³´ê³ **
   - ì°¨íŠ¸ ìƒì„±, Excel ì €ì¥, ìš”ì•½ ë³´ê³ ì„œ

6. **ìë™í™” ì‹œìŠ¤í…œ**
   - ì›ìŠ¤í†± ë¶„ì„, ì¢…í•© ë³´ê³ ì„œ ìë™ ìƒì„±

### ì‹¤ë¬´ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ëŠ” íŒ¨í„´

```python
# íŒ¨í„´ 1: ì¡°ê±´ë³„ í•„í„°ë§
high_value_stocks = df[
    (df['ì‹œê°€ì´ì•¡'] > 1000000) & 
    (df['PER'] < 15) & 
    (df['ROE'] > 5)
]

# íŒ¨í„´ 2: ê·¸ë£¹ë³„ ì§‘ê³„
sector_analysis = df.groupby('ì—…ì¢…')['ì‹œê°€ì´ì•¡'].agg(['sum', 'mean', 'count'])

# íŒ¨í„´ 3: ìˆœìœ„ ë§¤ê¸°ê¸°
df['ì‹œê°€ì´ì•¡_ìˆœìœ„'] = df['ì‹œê°€ì´ì•¡'].rank(ascending=False)

# íŒ¨í„´ 4: ë°±ë¶„ìœ„ìˆ˜ í™œìš©
df['ê°€ê²©_ë°±ë¶„ìœ„'] = df['í˜„ì¬ê°€'].rank(pct=True) * 100

# íŒ¨í„´ 5: ì›ìŠ¤í†± ìë™í™”
results = run_complete_analysis('ë„¤ì´ë²„ì½”ìŠ¤í”¼.csv')
```

ì´ëŸ¬í•œ íŒ¨í„´ë“¤ì„ ì¡°í•©í•˜ì—¬ ë‹¤ì–‘í•œ ë¶„ì„ ìš”êµ¬ì‚¬í•­ì— ëŒ€ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸ¯