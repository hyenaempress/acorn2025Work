#17.03 ğŸ“Š ì´ìƒì¹˜ì™€ ê²°ì¸¡ì¹˜ ê°€ì´ë“œ

> **ë°ì´í„° ë¶„ì„ì˜ ì²«ê±¸ìŒ: ë°ì´í„° í’ˆì§ˆ ë¬¸ì œ ì´í•´í•˜ê³  í•´ê²°í•˜ê¸°**
-íŒë‹¤ìŠ¤ì—ì„œ ë°ì´í„° ì •ì œë¥¼ í•  ë•Œ ê°€ì¥ ì¤‘ìš”í•œ í¬ì¸íŠ¸ 

---

## ğŸ¯ **í•µì‹¬ ê°œë… ì •ë¦¬**

### **ê²°ì¸¡ì¹˜ (Missing Values)** 
- **ì •ì˜**: ë°ì´í„°ì—ì„œ **ê°’ì´ ë¹„ì–´ìˆëŠ”** ìƒíƒœ
- **í‘œí˜„**: `NaN` (Not a Number), `None`, ë¹ˆ ë¬¸ìì—´ ë“±
- **ì›ì¸**: ë°ì´í„° ìˆ˜ì§‘ ì˜¤ë¥˜, ì‘ë‹µ ê±°ë¶€, ì‹œìŠ¤í…œ ì¥ì•  ë“±
- **ì˜í–¥**: ë¶„ì„ ê²°ê³¼ ì™œê³¡, ëª¨ë¸ ì„±ëŠ¥ ì €í•˜

### **ì´ìƒì¹˜ (Outliers)**
- **ì •ì˜**: ë‹¤ë¥¸ ë°ì´í„°ë“¤ê³¼ ë¹„êµí–ˆì„ ë•Œ **ë„ˆë¬´ í¬ê±°ë‚˜ ì‘ì•„ì„œ** ì „ì²´ ë¶„í¬ì—ì„œ ë²—ì–´ë‚˜ëŠ” ê°’
- **íŠ¹ì§•**: í†µê³„ì ìœ¼ë¡œ ê·¹ë‹¨ì ì¸ ê°’
- **ì›ì¸**: ì¸¡ì • ì˜¤ë¥˜, ì…ë ¥ ì‹¤ìˆ˜, íŠ¹ë³„í•œ ìƒí™©
- **ì˜í–¥**: í‰ê· ê°’ ì™œê³¡, ë¶„ì‚° ì¦ê°€, ëª¨ë¸ í¸í–¥

---

## ğŸ” **ê²°ì¸¡ì¹˜ íƒì§€ ë° ì²˜ë¦¬**

### **1. ê²°ì¸¡ì¹˜ í™•ì¸í•˜ê¸°**

```python
import pandas as pd
import numpy as np

# ìƒ˜í”Œ ë°ì´í„° ìƒì„±
data = {
    'ì´ë¦„': ['ê¹€ì² ìˆ˜', 'ì´ì˜í¬', None, 'ë°•ë¯¼ìˆ˜', 'ìµœì§€í˜œ'],
    'ë‚˜ì´': [25, np.nan, 30, 28, 24],
    'ì—°ë´‰': [3000, 4500, np.nan, 5200, None],
    'ë¶€ì„œ': ['ê°œë°œ', 'ë§ˆì¼€íŒ…', 'ê°œë°œ', '', 'ì¸ì‚¬']
}
df = pd.DataFrame(data)

# ê²°ì¸¡ì¹˜ í™•ì¸
print("ğŸ“‹ ê¸°ë³¸ ë°ì´í„°:")
print(df)

print("\nğŸ” ê²°ì¸¡ì¹˜ í™•ì¸:")
print(df.isnull())  # True/Falseë¡œ ê²°ì¸¡ì¹˜ ìœ„ì¹˜ í™•ì¸

print("\nğŸ“Š ê° ì—´ë³„ ê²°ì¸¡ì¹˜ ê°œìˆ˜:")
print(df.isnull().sum())

print("\nğŸ’¯ ê²°ì¸¡ì¹˜ ë¹„ìœ¨ (%):") 
print((df.isnull().sum() / len(df)) * 100)
```

### **2. ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ë°©ë²•**

#### **ë°©ë²• 1: ì‚­ì œí•˜ê¸°** 
```python
# ê²°ì¸¡ì¹˜ê°€ í¬í•¨ëœ í–‰ ì „ì²´ ì‚­ì œ
df_drop_rows = df.dropna()
print("í–‰ ì‚­ì œ í›„:", df_drop_rows.shape)

# ê²°ì¸¡ì¹˜ê°€ í¬í•¨ëœ ì—´ ì „ì²´ ì‚­ì œ  
df_drop_cols = df.dropna(axis=1)
print("ì—´ ì‚­ì œ í›„:", df_drop_cols.shape)

# íŠ¹ì • ì—´ì˜ ê²°ì¸¡ì¹˜ë§Œ ê³ ë ¤í•´ì„œ ì‚­ì œ
df_drop_specific = df.dropna(subset=['ë‚˜ì´'])
print("ë‚˜ì´ ê²°ì¸¡ì¹˜ë§Œ ì‚­ì œ:", df_drop_specific.shape)
```

#### **ë°©ë²• 2: ì±„ì›Œë„£ê¸° (Imputation)**
```python
# 0ìœ¼ë¡œ ì±„ìš°ê¸°
df_fill_zero = df.fillna(0)

# í‰ê· ê°’ìœ¼ë¡œ ì±„ìš°ê¸° (ìˆ«ìí˜• ë°ì´í„°)
df['ë‚˜ì´'] = df['ë‚˜ì´'].fillna(df['ë‚˜ì´'].mean())

# ìµœë¹ˆê°’ìœ¼ë¡œ ì±„ìš°ê¸° (ë²”ì£¼í˜• ë°ì´í„°)
df['ë¶€ì„œ'] = df['ë¶€ì„œ'].fillna(df['ë¶€ì„œ'].mode()[0])

# ì´ì „ê°’ìœ¼ë¡œ ì±„ìš°ê¸°
df_ffill = df.fillna(method='ffill')

# ë‹¤ìŒê°’ìœ¼ë¡œ ì±„ìš°ê¸°
df_bfill = df.fillna(method='bfill')
```

### **3. ê³ ê¸‰ ê²°ì¸¡ì¹˜ ì²˜ë¦¬**
```python
# ì¡°ê±´ë¶€ ì±„ìš°ê¸°
df.loc[df['ë¶€ì„œ'].isnull(), 'ë¶€ì„œ'] = 'ë¯¸ì§€ì •'

# ë‹¤ë¥¸ ì—´ì˜ ê°’ì— ë”°ë¼ ì±„ìš°ê¸°
df['ì—°ë´‰'] = df.groupby('ë¶€ì„œ')['ì—°ë´‰'].transform(
    lambda x: x.fillna(x.mean())
)
```

---

## âš ï¸ **ì´ìƒì¹˜ íƒì§€ ë° ì²˜ë¦¬**

### **1. ì´ìƒì¹˜ íƒì§€ ë°©ë²•**

#### **ë°©ë²• 1: í†µê³„ì  ë°©ë²• (Z-score)**
```python
# ì—°ë´‰ ë°ì´í„°ë¡œ ì´ìƒì¹˜ íƒì§€
salaries = [3000, 3200, 2800, 3100, 50000, 3300, 2900]  # 50000ì´ ì´ìƒì¹˜
df_salary = pd.DataFrame({'ì—°ë´‰': salaries})

# Z-score ê³„ì‚°
df_salary['z_score'] = (df_salary['ì—°ë´‰'] - df_salary['ì—°ë´‰'].mean()) / df_salary['ì—°ë´‰'].std()

# Z-scoreê°€ Â±3ì„ ë„˜ìœ¼ë©´ ì´ìƒì¹˜ë¡œ íŒë‹¨
outliers_z = df_salary[abs(df_salary['z_score']) > 3]
print("Z-score ì´ìƒì¹˜:")
print(outliers_z)
```

#### **ë°©ë²• 2: IQR (ì‚¬ë¶„ìœ„ìˆ˜ ë²”ìœ„) ë°©ë²•**
```python
# IQR ë°©ë²•ìœ¼ë¡œ ì´ìƒì¹˜ íƒì§€
Q1 = df_salary['ì—°ë´‰'].quantile(0.25)  # 1ì‚¬ë¶„ìœ„ìˆ˜
Q3 = df_salary['ì—°ë´‰'].quantile(0.75)  # 3ì‚¬ë¶„ìœ„ìˆ˜
IQR = Q3 - Q1

# ì´ìƒì¹˜ ê²½ê³„ê°’ ì„¤ì •
lower_bound = Q1 - 1.5 * IQR
upper_bound = Q3 + 1.5 * IQR

# ì´ìƒì¹˜ ì°¾ê¸°
outliers_iqr = df_salary[
    (df_salary['ì—°ë´‰'] < lower_bound) | 
    (df_salary['ì—°ë´‰'] > upper_bound)
]
print(f"IQR ì´ìƒì¹˜ (ë²”ìœ„: {lower_bound:.0f} ~ {upper_bound:.0f}):")
print(outliers_iqr)
```

#### **ë°©ë²• 3: ë°±ë¶„ìœ„ìˆ˜ ë°©ë²•**
```python
# ìƒìœ„/í•˜ìœ„ 5% ì´ìƒì¹˜ë¡œ íŒë‹¨
lower_percentile = df_salary['ì—°ë´‰'].quantile(0.05)
upper_percentile = df_salary['ì—°ë´‰'].quantile(0.95)

outliers_percentile = df_salary[
    (df_salary['ì—°ë´‰'] < lower_percentile) | 
    (df_salary['ì—°ë´‰'] > upper_percentile)
]
print("ë°±ë¶„ìœ„ìˆ˜ ì´ìƒì¹˜:")
print(outliers_percentile)
```

### **2. ì´ìƒì¹˜ ì²˜ë¦¬ ë°©ë²•**

#### **ë°©ë²• 1: ì‚­ì œí•˜ê¸°**
```python
# ì´ìƒì¹˜ ì œê±°
df_clean = df_salary[
    (df_salary['ì—°ë´‰'] >= lower_bound) & 
    (df_salary['ì—°ë´‰'] <= upper_bound)
]
print("ì´ìƒì¹˜ ì œê±° í›„:", df_clean)
```

#### **ë°©ë²• 2: ë³€í™˜í•˜ê¸°**
```python
# ê²½ê³„ê°’ìœ¼ë¡œ ì¹˜í™˜ (Capping)
df_salary['ì—°ë´‰_ì²˜ë¦¬'] = df_salary['ì—°ë´‰'].copy()
df_salary.loc[df_salary['ì—°ë´‰_ì²˜ë¦¬'] > upper_bound, 'ì—°ë´‰_ì²˜ë¦¬'] = upper_bound
df_salary.loc[df_salary['ì—°ë´‰_ì²˜ë¦¬'] < lower_bound, 'ì—°ë´‰_ì²˜ë¦¬'] = lower_bound

print("ê²½ê³„ê°’ ì¹˜í™˜ í›„:")
print(df_salary)
```

#### **ë°©ë²• 3: ë¡œê·¸ ë³€í™˜**
```python
# ë¡œê·¸ ë³€í™˜ìœ¼ë¡œ ì´ìƒì¹˜ ì™„í™”
df_salary['ì—°ë´‰_log'] = np.log(df_salary['ì—°ë´‰'])
print("ë¡œê·¸ ë³€í™˜ í›„:")
print(df_salary[['ì—°ë´‰', 'ì—°ë´‰_log']])
```

---

## ğŸ“Š **ì‹œê°í™”ë¡œ í™•ì¸í•˜ê¸°**

```python
import matplotlib.pyplot as plt
import seaborn as sns

# í•œê¸€ í°íŠ¸ ì„¤ì • (Windows)
plt.rcParams['font.family'] = 'Malgun Gothic'
plt.rcParams['axes.unicode_minus'] = False

# ì„œë¸Œí”Œë¡¯ ìƒì„±
fig, axes = plt.subplots(2, 2, figsize=(12, 10))

# 1. ê²°ì¸¡ì¹˜ íˆíŠ¸ë§µ
sns.heatmap(df.isnull(), cmap='viridis', cbar=True, ax=axes[0,0])
axes[0,0].set_title('ê²°ì¸¡ì¹˜ ë¶„í¬')

# 2. ë°•ìŠ¤í”Œë¡¯ìœ¼ë¡œ ì´ìƒì¹˜ í™•ì¸
df_salary.boxplot(column='ì—°ë´‰', ax=axes[0,1])
axes[0,1].set_title('ì—°ë´‰ ë°•ìŠ¤í”Œë¡¯ (ì´ìƒì¹˜ í™•ì¸)')

# 3. íˆìŠ¤í† ê·¸ë¨
df_salary['ì—°ë´‰'].hist(bins=20, ax=axes[1,0])
axes[1,0].set_title('ì—°ë´‰ ë¶„í¬')

# 4. ì‚°ì ë„
axes[1,1].scatter(range(len(df_salary)), df_salary['ì—°ë´‰'])
axes[1,1].set_title('ì—°ë´‰ ì‚°ì ë„')
axes[1,1].set_xlabel('ì¸ë±ìŠ¤')
axes[1,1].set_ylabel('ì—°ë´‰')

plt.tight_layout()
plt.show()
```

---

## ğŸš€ **ì‹¤ë¬´ì—ì„œì˜ ì ‘ê·¼ë²•**

### **1. ì²´ê³„ì ì¸ ë°ì´í„° í’ˆì§ˆ ê²€ì‚¬**

```python
def data_quality_report(df):
    """ë°ì´í„° í’ˆì§ˆ ë¦¬í¬íŠ¸ ìƒì„±"""
    print("=" * 50)
    print("ğŸ“‹ ë°ì´í„° í’ˆì§ˆ ë¦¬í¬íŠ¸")
    print("=" * 50)
    
    print(f"ğŸ“Š ì „ì²´ ë°ì´í„° í¬ê¸°: {df.shape}")
    print(f"ğŸ”¢ ì „ì²´ ë°ì´í„° ê°œìˆ˜: {df.size:,}")
    
    print("\nğŸ“ˆ ê° ì—´ë³„ ì •ë³´:")
    print(df.info())
    
    print("\nâŒ ê²°ì¸¡ì¹˜ í˜„í™©:")
    missing_stats = df.isnull().sum()
    missing_percent = (missing_stats / len(df)) * 100
    missing_report = pd.DataFrame({
        'ê²°ì¸¡ì¹˜_ê°œìˆ˜': missing_stats,
        'ê²°ì¸¡ì¹˜_ë¹„ìœ¨(%)': missing_percent.round(2)
    })
    print(missing_report[missing_report['ê²°ì¸¡ì¹˜_ê°œìˆ˜'] > 0])
    
    print("\nâš ï¸ ìˆ˜ì¹˜í˜• ë°ì´í„° ì´ìƒì¹˜ í™•ì¸:")
    numeric_cols = df.select_dtypes(include=[np.number]).columns
    for col in numeric_cols:
        Q1 = df[col].quantile(0.25)
        Q3 = df[col].quantile(0.75)
        IQR = Q3 - Q1
        lower_bound = Q1 - 1.5 * IQR
        upper_bound = Q3 + 1.5 * IQR
        
        outliers = df[(df[col] < lower_bound) | (df[col] > upper_bound)]
        if len(outliers) > 0:
            print(f"  {col}: {len(outliers)}ê°œ ì´ìƒì¹˜ ë°œê²¬")

# ë¦¬í¬íŠ¸ ì‹¤í–‰
data_quality_report(df)
```

### **2. ìë™í™”ëœ ì „ì²˜ë¦¬ íŒŒì´í”„ë¼ì¸**

```python
class DataPreprocessor:
    """ë°ì´í„° ì „ì²˜ë¦¬ ìë™í™” í´ë˜ìŠ¤"""
    
    def __init__(self):
        self.missing_strategy = {}
        self.outlier_strategy = {}
    
    def handle_missing(self, df, strategy='auto'):
        """ê²°ì¸¡ì¹˜ ì²˜ë¦¬"""
        processed_df = df.copy()
        
        for col in df.columns:
            missing_ratio = df[col].isnull().sum() / len(df)
            
            if missing_ratio > 0.5:  # 50% ì´ìƒ ê²°ì¸¡ì¹˜ë©´ ì—´ ì‚­ì œ ê³ ë ¤
                print(f"âš ï¸ {col} ì—´ì˜ ê²°ì¸¡ì¹˜ ë¹„ìœ¨ì´ {missing_ratio:.2%}ë¡œ ë†’ìŠµë‹ˆë‹¤.")
                
            elif df[col].dtype in ['int64', 'float64']:  # ìˆ«ìí˜•
                processed_df[col] = df[col].fillna(df[col].median())
                
            else:  # ë²”ì£¼í˜•
                processed_df[col] = df[col].fillna(df[col].mode()[0] if len(df[col].mode()) > 0 else 'ë¯¸ì§€ì •')
        
        return processed_df
    
    def handle_outliers(self, df, method='iqr'):
        """ì´ìƒì¹˜ ì²˜ë¦¬"""
        processed_df = df.copy()
        numeric_cols = df.select_dtypes(include=[np.number]).columns
        
        for col in numeric_cols:
            if method == 'iqr':
                Q1 = df[col].quantile(0.25)
                Q3 = df[col].quantile(0.75)
                IQR = Q3 - Q1
                lower_bound = Q1 - 1.5 * IQR
                upper_bound = Q3 + 1.5 * IQR
                
                # ê²½ê³„ê°’ìœ¼ë¡œ ì¹˜í™˜
                processed_df[col] = df[col].clip(lower_bound, upper_bound)
        
        return processed_df

# ì‚¬ìš© ì˜ˆì‹œ
preprocessor = DataPreprocessor()
df_processed = preprocessor.handle_missing(df)
df_final = preprocessor.handle_outliers(df_processed)
```

---

## ğŸ’¡ **í•µì‹¬ ìš”ì•½ ë° ì‹¤ë¬´ íŒ**

### **ğŸ¯ ê²°ì¸¡ì¹˜ ì²˜ë¦¬ ê°€ì´ë“œë¼ì¸**
- **10% ë¯¸ë§Œ**: ì‚­ì œ ê³ ë ¤
- **10-30%**: ëŒ€ì²´ê°’ ì‚¬ìš© (í‰ê· , ì¤‘ê°„ê°’, ìµœë¹ˆê°’)
- **30% ì´ìƒ**: ì—´ ì‚­ì œ ë˜ëŠ” ê³ ê¸‰ imputation ê¸°ë²• ì‚¬ìš©

### **ğŸ¯ ì´ìƒì¹˜ ì²˜ë¦¬ ê°€ì´ë“œë¼ì¸**
- **ì¸¡ì • ì˜¤ë¥˜**: ì‚­ì œí•˜ê±°ë‚˜ ì˜¬ë°”ë¥¸ ê°’ìœ¼ë¡œ ìˆ˜ì •
- **ìì—°ìŠ¤ëŸ¬ìš´ ê·¹ê°’**: ìœ ì§€í•˜ë˜ ë³„ë„ ë¶„ì„
- **ëª¨ë¸ ì„±ëŠ¥ì— ì•…ì˜í–¥**: ë³€í™˜(ë¡œê·¸, ì œê³±ê·¼) ë˜ëŠ” ê²½ê³„ê°’ ì¹˜í™˜

### **ğŸ¯ ì²˜ë¦¬ ìˆœì„œ**
1. **íƒìƒ‰ì  ë°ì´í„° ë¶„ì„** (EDA)
2. **ê²°ì¸¡ì¹˜ íŒ¨í„´ ë¶„ì„**
3. **ì´ìƒì¹˜ íƒì§€ ë° ì›ì¸ ë¶„ì„**
4. **ë„ë©”ì¸ ì§€ì‹ í™œìš©í•œ íŒë‹¨**
5. **ì²˜ë¦¬ í›„ ê²€ì¦**

### **âš¡ ìì£¼ ì‚¬ìš©í•˜ëŠ” í•¨ìˆ˜ë“¤**
```python
# ê²°ì¸¡ì¹˜ ê´€ë ¨
df.isnull().sum()           # ê²°ì¸¡ì¹˜ ê°œìˆ˜
df.dropna()                 # ê²°ì¸¡ì¹˜ ì‚­ì œ
df.fillna(ê°’)               # ê²°ì¸¡ì¹˜ ì±„ìš°ê¸°

# ì´ìƒì¹˜ ê´€ë ¨  
df.describe()               # ê¸°ì´ˆí†µê³„ëŸ‰ í™•ì¸
df.quantile([0.25, 0.75])  # ì‚¬ë¶„ìœ„ìˆ˜
df.boxplot()                # ë°•ìŠ¤í”Œë¡¯ ê·¸ë¦¬ê¸°
```

---

## ğŸ‰ **ë§ˆë¬´ë¦¬**

ì´ìƒì¹˜ì™€ ê²°ì¸¡ì¹˜ëŠ” **ë°ì´í„° ë¶„ì„ì˜ ì²« ê´€ë¬¸**ì…ë‹ˆë‹¤! 
- âœ… ê²°ì¸¡ì¹˜ = ë¹„ì–´ìˆëŠ” ë°ì´í„° â†’ **íƒì§€í•˜ê³  ì ì ˆíˆ ì²˜ë¦¬**
- âœ… ì´ìƒì¹˜ = ê·¹ë‹¨ì ì¸ ê°’ â†’ **ì›ì¸ íŒŒì•… í›„ ì²˜ë¦¬ ë°©ë²• ê²°ì •**
- âœ… **ë„ë©”ì¸ ì§€ì‹**ê³¼ **ë°ì´í„° íŠ¹ì„±**ì„ ê³ ë ¤í•œ ì²˜ë¦¬ê°€ í•µì‹¬!

**ë‹¤ìŒ ë‹¨ê³„**: ê¹¨ë—í•´ì§„ ë°ì´í„°ë¡œ ë³¸ê²©ì ì¸ ë¶„ì„ê³¼ ëª¨ë¸ë§ ì‹œì‘! ğŸ’ª
