# 18.16 데이터 시각화 기초 완전 정리

## 🎯 개요
이번 강의에서는 **Tips 데이터셋**을 활용한 데이터 전처리부터 시각화까지의 전체 워크플로우를 다뤘습니다. pandas의 groupby 연산, 사용자 정의 함수 활용, 그리고 matplotlib을 통한 시각화까지 실무에서 자주 사용되는 패턴들을 정리했습니다.

---

## 📊 Tips 데이터셋 분석 워크플로우

### 1. 데이터 로드 및 기본 정보 확인
```python
import pandas as pd
import matplotlib.pyplot as plt

# 데이터 로드
tips = pd.read_csv('https://raw.githubusercontent.com/pykwon/python/refs/heads/master/testdata_utf8/tips.csv')

# 데이터 구조 확인
print(tips.info())
print(tips.head(3))
```

### 2. 컬럼명 변경 및 데이터 정리
```python
# 컬럼명 변경 (sex → gender)
tips['gender'] = tips['sex']  # 새로운 컬럼 생성
del tips['sex']               # 기존 컬럼 삭제

print(tips.head(3))
```

### 3. 파생 변수 생성 - 팁 비율 계산
```python
# 팁 비율 계산 (tip / total_bill)
tips['tip_pct'] = tips['tip'] / tips['total_bill']

print(tips.head(3))
```

---

## 🔄 GroupBy 연산과 통계 분석

### 1. 다중 그룹핑 - 성별과 흡연 여부
```python
# 성별과 흡연 여부별 평균 계산
tip_pct_group = tips.groupby([tips['gender'], tips['smoker']]).mean()
print(tip_pct_group)
```

### 2. 기본 통계 함수들
```python
# 다양한 통계값 계산
print(tip_pct_group.sum())      # 합계
print(tip_pct_group.max())      # 최댓값  
print(tip_pct_group.min())      # 최솟값
print(tip_pct_group.describe()) # 기술통계 요약
```

### 3. agg() 함수 활용 - 여러 통계량 한번에
```python
# 여러 통계 함수를 한번에 적용
print(tip_pct_group.agg('sum'))                    # 단일 함수
print(tip_pct_group.agg(['sum', 'mean']))          # 다중 함수
print(tip_pct_group.agg(['sum', 'mean', 'var']))   # 분산 추가
```

---

## 🛠️ 사용자 정의 함수와 고급 분석

### 1. 커스텀 함수 정의
```python
# 최댓값과 최솟값의 차이를 계산하는 함수
def myFunc(group):
    diff = group.max() - group.min()
    return diff
```

### 2. 내장 함수와 사용자 정의 함수 조합
```python
# ⚠️ 중요한 차이점!
# 내장 함수: 함수명만 작성 (따옴표 없이)
# 사용자 정의 함수: 함수 객체 자체를 전달

result2 = tip_pct_group.agg(['sum', 'mean', 'var', 'max', myFunc])
print(result2)
```

**핵심 포인트:**
- **내장 함수**: `'sum'`, `'mean'`, `'var'`, `'max'` (문자열로)
- **사용자 정의 함수**: `myFunc` (함수 객체로)

---

## 📈 데이터 시각화 구현

### 1. 가로 막대 그래프 생성
```python
# pandas와 matplotlib 연동
result2.plot(kind='barh',           # 가로 막대그래프
            title='agg func result', # 제목
            stacked=True)            # 누적 차트
plt.show()
```

### 2. 차트 스타일 옵션
- **kind='barh'**: 가로 막대그래프
- **title**: 차트 제목
- **stacked=True**: 누적 차트 (각 막대가 쌓여서 표시)

---

## 🎨 시각화 라이브러리 생태계

### 발전 단계별 정리
```
1단계: Matplotlib (기초) 
   ↓
2단계: Seaborn (아름다운 통계 시각화)
   ↓  
3단계: Chart.js (웹 환경 시각화)
   ↓
4단계: 고급 라이브러리 (Plotly, Bokeh 등)
```

### 환경별 시각화 도구 선택
```python
# 📊 데스크톱 환경 (분석용)
# matplotlib + seaborn → 파일 저장 (PNG, PDF)
plt.savefig('analysis_result.png', dpi=300, bbox_inches='tight')

# 🌐 웹 환경 (서비스용)  
# Chart.js → 이미지 생성 후 웹에 표시
# 동적 인터랙션 가능
```

---

## 💡 실무 활용 팁

### 1. 분석 워크플로우 체계화
```python
# 1. 데이터 로드 및 탐색
data = pd.read_csv('dataset.csv')
print(data.info())

# 2. 데이터 전처리
data['new_column'] = data['col1'] / data['col2']

# 3. 그룹 분석
grouped = data.groupby(['category1', 'category2']).agg(['mean', 'sum'])

# 4. 시각화
grouped.plot(kind='bar', figsize=(10, 6))
plt.show()
```

### 2. 함수 활용 전략
```python
# 재사용 가능한 분석 함수 만들기
def analyze_tips_by_group(data, group_cols, target_col):
    """팁 데이터 그룹별 분석 함수"""
    grouped = data.groupby(group_cols)[target_col].agg(['mean', 'std', 'count'])
    grouped.plot(kind='barh', title=f'{target_col} Analysis')
    plt.show()
    return grouped

# 사용 예시
result = analyze_tips_by_group(tips, ['gender', 'smoker'], 'tip_pct')
```

### 3. 차트 선택 가이드
| 데이터 특성 | 추천 차트 | 사용 상황 |
|------------|----------|----------|
| 카테고리별 비교 | 막대그래프 | 그룹별 수치 비교 |
| 시계열 데이터 | 선 그래프 | 시간에 따른 변화 |
| 분포 확인 | 히스토그램, 박스플롯 | 데이터 분포 패턴 |
| 관계 분석 | 산점도 | 변수 간 상관관계 |
| 비율 표현 | 파이차트 | 전체 대비 부분 비율 |

---

## 🚀 다음 단계: 데이터베이스 연동

### 시각화에서 데이터베이스로
```python
# 현재까지의 여정
# 1. NumPy (수치 계산) ✅
# 2. Pandas (데이터 처리) ✅  
# 3. Matplotlib (시각화) ✅
# 4. 다음: 데이터베이스 (데이터 저장 및 관리) 🎯
```

### 실무 데이터 파이프라인
```
데이터베이스 → pandas → 분석/시각화 → 웹 서비스
    ↓           ↓         ↓           ↓
   MySQL    DataFrame   Chart.js    사용자
```

---

## 📝 핵심 정리

### ✅ 완료한 내용
1. **데이터 전처리**: 컬럼 변경, 파생 변수 생성
2. **그룹 분석**: groupby + agg 활용
3. **사용자 정의 함수**: 커스텀 분석 로직 구현
4. **시각화**: pandas + matplotlib 연동

### 🎯 중요 포인트
- **agg() 함수**: 여러 통계량을 한번에 계산
- **내장 vs 사용자 정의**: 함수 전달 방식의 차이
- **plot() 메서드**: pandas DataFrame에서 직접 시각화
- **stacked 옵션**: 누적 차트로 다중 비교

### 🔄 실무 활용도
- **높음**: groupby + agg 패턴은 실무에서 매우 자주 사용
- **중요**: 사용자 정의 함수로 반복 작업 자동화
- **필수**: 시각화를 통한 데이터 인사이트 도출

---

## 🎓 다음 학습 방향

### 즉시 활용 가능
1. **다양한 데이터셋**으로 동일한 패턴 연습
2. **Seaborn**으로 더 아름다운 차트 제작
3. **Chart.js**로 웹 환경 시각화 구현

### 중장기 목표
1. **데이터베이스** 연동을 통한 실시간 분석
2. **대시보드** 구축으로 비즈니스 인텔리전스
3. **머신러닝** 결과 시각화

**데이터 시각화 기초 완료! 🎉**  
이제 **데이터베이스**로 더 큰 그림을 그려봅시다!

---

## 🚨 강의에서 강조한 중요 체크 포인트

### 1. **사용자 정의 함수 vs 내장 함수의 차이점** ⚠️
```python
# ✅ 내장 함수 - 따옴표로 감싸기
result = tips_grouped.agg(['sum', 'mean', 'var', 'max'])

# ✅ 사용자 정의 함수 - 함수 객체 그대로
def myFunc(group):
    diff = group.max() - group.min()
    return diff

result = tips_grouped.agg(['sum', 'mean', 'var', 'max', myFunc])  # 따옴표 없이!
```

**💡 핵심**: "내장된 함수일 때는 따옴표를 넣어주고, 사용자 정의 함수는 그냥 함수명만 쓴다"

### 2. **웹 시각화 vs 독립 시각화의 구분** 🌐
```python
# 독립적 실행 (분석용)
plt.plot(data)
plt.savefig('chart.png')  # 파일로 저장
plt.show()

# 웹 환경 (서비스용)  
# Chart.js 라이브러리 사용 → 동적 인터랙티브 차트
```

**💡 핵심**: "독립적으로 운영할 때는 파일로 저장하지만, 웹에서 시각화할 때는 Chart.js 같은 라이브러리를 써서 동적으로 움직이는 차트를 만든다"

### 3. **데이터 시각화 → 데이터베이스 연동** 🔄
강의에서 명확히 언급한 학습 로드맵:
```
NumPy → Pandas → Matplotlib (시각화) → 데이터베이스
```

**💡 핵심**: "이제부터는 데이터베이스에 대한 이야기를 할 거예요. 파이썬에서 데이터베이스로 넘어가서 pandas를 이용해서..."

### 4. **파생 변수 생성의 중요성** 📊
```python
# 원본 데이터에서 새로운 인사이트 도출
tips['tip_pct'] = tips['tip'] / tips['total_bill']  # 팁 비율 계산

# 이런 파생 변수가 실제 분석에서 핵심!
```

**💡 핵심**: 원본 데이터만으로는 부족하고, 비율이나 계산된 값들이 더 의미있는 분석을 가능하게 함

### 5. **GroupBy + agg() 조합의 실무 중요성** 💼
```python
# 실무에서 가장 많이 사용하는 패턴
grouped = tips.groupby(['gender', 'smoker']).agg(['sum', 'mean', 'var', 'max'])
```

**💡 핵심**: 카테고리별 통계를 한 번에 구할 수 있는 강력한 기능 - 실무에서 매일 사용

### 6. **시각화의 한계와 대안** 📈
- **막대그래프, 파이차트**: 소량 데이터만 적합
- **히스토그램, 박스플롯**: 대량 데이터 분포 확인
- **산점도**: 상관관계 분석 (앞으로 많이 만날 예정)

---

## 🎓 놓치면 안 되는 핵심 개념

### ✅ **반드시 기억할 것들**
1. **함수 전달 방식의 차이** - agg()에서 내장함수 vs 사용자정의함수
2. **웹 시각화의 동적 특성** - Chart.js의 인터랙티브 기능  
3. **다음 학습 단계** - 데이터베이스 연동 준비
4. **실무 패턴** - groupby + agg 조합의 활용도

### 🔮 **실무에서의 활용**
- 이 내용들은 데이터 분석 실무에서 **매일 사용**하는 핵심 기술
- 특히 **agg() 함수**의 올바른 사용법은 판다스 활용의 핵심
- **시각화 환경 구분**은 프로젝트 성격에 따른 적절한 도구 선택의 기준

이제 정말로 **데이터베이스**로 넘어갈 준비가 완료되었습니다! 🚀